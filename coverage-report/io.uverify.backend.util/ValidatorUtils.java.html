<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ValidatorUtils.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Uverify Backend</a> &gt; <a href="index.source.html" class="el_package">io.uverify.backend.util</a> &gt; <span class="el_source">ValidatorUtils.java</span></div><h1>ValidatorUtils.java</h1><pre class="source lang-java linenums">/*
 * UVerify Backend
 * Copyright (C) 2025 Fabian Bormann
 *
 *  This program is free software: you can redistribute it and/or modify
 *  it under the terms of the GNU Affero General Public License as published by
 *  the Free Software Foundation, either version 3 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU Affero General Public License for more details.
 *
 *  You should have received a copy of the GNU Affero General Public License
 *  along with this program. If not, see &lt;http://www.gnu.org/licenses/&gt;.
 */

package io.uverify.backend.util;

import com.bloxbean.cardano.client.api.exception.ApiException;
import com.bloxbean.cardano.client.api.model.Result;
import com.bloxbean.cardano.client.api.model.Utxo;
import com.bloxbean.cardano.client.backend.api.BackendService;
import com.bloxbean.cardano.client.backend.model.TxContentOutputAmount;
import com.bloxbean.cardano.client.backend.model.TxContentUtxo;
import com.bloxbean.cardano.client.backend.model.TxContentUtxoOutputs;
import com.bloxbean.cardano.client.plutus.blueprint.PlutusBlueprintUtil;
import com.bloxbean.cardano.client.plutus.blueprint.model.PlutusVersion;
import com.bloxbean.cardano.client.plutus.spec.*;
import com.bloxbean.cardano.client.transaction.spec.TransactionOutput;
import com.bloxbean.cardano.client.util.HexUtil;
import com.bloxbean.cardano.yaci.store.common.domain.AddressUtxo;
import com.bloxbean.cardano.yaci.store.common.domain.Amt;
import io.uverify.backend.enums.CardanoNetwork;
import lombok.extern.slf4j.Slf4j;
import org.apache.commons.codec.binary.Hex;
import org.apache.commons.codec.digest.DigestUtils;
import scalus.bloxbean.ScalusScriptUtils;

import java.math.BigInteger;
import java.nio.charset.StandardCharsets;
import java.util.List;
import java.util.Optional;
import java.util.stream.Collectors;

<span class="fc" id="L47">@Slf4j</span>
<span class="nc" id="L48">public class ValidatorUtils {</span>
    public static String getProxyStateTokenName(String txHash, int outputIndex) {
        // Convert hex string to bytes
        byte[] txHashBytes;
        try {
<span class="fc" id="L53">            txHashBytes = Hex.decodeHex(txHash.toCharArray());</span>
<span class="nc" id="L54">        } catch (java.lang.Exception exception) {</span>
<span class="nc" id="L55">            log.error(exception.getMessage());</span>
<span class="nc" id="L56">            return &quot;&quot;;</span>
<span class="fc" id="L57">        }</span>
        // Convert outputIndex to string and then to bytes
<span class="fc" id="L59">        String outputIndexString = String.valueOf(outputIndex);</span>
<span class="fc" id="L60">        byte[] outputIndexBytes = outputIndexString.getBytes(StandardCharsets.UTF_8);</span>

        // Combine both byte arrays
<span class="fc" id="L63">        byte[] messageBuffer = new byte[txHashBytes.length + outputIndexBytes.length];</span>
<span class="fc" id="L64">        System.arraycopy(txHashBytes, 0, messageBuffer, 0, txHashBytes.length);</span>
<span class="fc" id="L65">        System.arraycopy(outputIndexBytes, 0, messageBuffer, txHashBytes.length, outputIndexBytes.length);</span>

        // Calculate SHA3-256 hash and return as hex string
<span class="fc" id="L68">        return DigestUtils.sha3_256Hex(messageBuffer);</span>
    }

    public static String validatorToScriptHash(PlutusScript script) {
        try {
<span class="fc" id="L73">            return HexUtil.encodeHexString(script.getScriptHash());</span>
<span class="nc" id="L74">        } catch (Exception e) {</span>
<span class="nc" id="L75">            log.error(&quot;Error computing policy id: &quot; + e.getMessage());</span>
<span class="nc" id="L76">            return null;</span>
        }
    }

    public static PlutusScript getUVerifyProxyContract() {
<span class="fc" id="L81">        String compiledCode = &quot;590a11010100229800aba4aba2aba1aba0aab9faab9eaab9dab9a488888889660033001300337540132232330010010032259800800c528456600266e3cdd71805000801c528c4cc008008c02c0050052010912cc004006297ae089980398021804000998010011804800a00c911919800800801912cc00400629422b30013375e601400200714a3133002002300b001401480426e1d200091191919800800802112cc00400600713233225980099b910070028acc004cdc78038014400600c804a26600a00a601e0088048dd718040009bab3009001300b0014024297adef6c609b874800a6e9520009112cc004cdc48012400110018cc00400e66e10009201499b8b3370066e14009201448180005003200891111919800800802912cc004006200b13259800800c4cc010c03400801a26600a601a004660060060028058c03400500a48c01cc0200052222222222298009809005cc04402e446601800400330090099192cc004cdc3a4008601e6ea8006264b3001300a3010375400313232332259800980c801c40162c80b0dd7180b0009bae301600230160013011375400316403c602660206ea80062c8070c048c04cc04cc03cdd5000c888c020c8cc88cc008008004896600200300389919912cc004cdc8803801456600266e3c01c00a20030064055133005005301b00440546eb8c050004dd6980a800980b800a02a3300a00400314800244646600200200644b30010018a60103d87a80008992cc004c010006260126602a00297ae0899801801980b80120223015001404d300300391192cc004c0280062b3001301137540070028b20248acc004c0200062b3001301137540070028b20248b201e403c601e6ea800922222222233223232980091b93337146eb8c07cc070dd50009b98373266004601e60386ea800522100980f006cc068dd50022444b30013017001899198048018991919194c004c09cc09c0066eacc09800660100549112cc004c07cc094dd500544c8c9660026042604e6ea80062b30013302232330010013758605801444b30010018a5eb82266058605a60546ea8c0b4004cc008008c0b800502b017c566002603e646600200200644b30010018a40011337009001198010011817000a0568acc004cc896600200514a11329800992cc004c094c0acdd5000c4dd6981618179bab302f302c375400314800102a1817000cdd798171817800cdd5801a444b30010018acc004c00801a26600a0069000452820588992cc004cdd79817000a6010140008acc004cc018010dd6981798191bab302f001898019ba630330028a5040b51598009980300224001130030078a5040b48168c0c400502f0ca60020030079119817801198179ba60014bd7020022225980080144cc005300103d87a80004bd6f7b63044ca60026eb8c0b40066eacc0b800660640069112cc004cdc8a441000038acc004cdc7a441000038998029813998199ba60024bd70000c4cc015300103d87a800000640bd19800803c006446600e0046606a66ec0dd48029ba6004001401c81786060004817229422942294102f1ba63302a337606ea4028dd31981519bb0375200698010101004bd6f7b63025eb7bdb1808928c566002646600200200644b30010018a508acc00660026eacc074c0a8dd51816800c03200a80ba2946266004004605c002814102b44cc060dd61815981618160029bae301b30283754602c605660506ea800629410264528204c8a50409914a081322c81316600200314c0103d87a80008980e998149815000a5eb8102819198008009bac302a0062259800800c52f5c11332259800992cc004c088c0a8dd5000c4cdc78069bae302e302b375400314a08148c0b4c0a8dd5181698151baa00289981600119802002000c4cc01001000502818158009816000a0528992cc004c080c098dd5000c56600330013302332330010013302000400a2259800800c52f5c113302b3028302c00133002002302d00140a80054a14a2812a266042602c6eacc0a8010cdd2a4004660526054604e6ea8c054c068c09cdd5181518139baa0014bd704528204a8b204a330123758605200c5300137566034604e6ea8c068c09cdd5000c02600480a10240c098c098004c094004c090004c07cdd50081bae3021301e375400f159800980a800c4c8cc88cc02c0144c8cc88c8c8cc8966002603e604e6ea800626644b300130233029375401d13259800981218151baa001899912cc004cc07401cdd7181018169baa0018acc004cdc79bae3020302d37540046eb8c080c0b4dd5000c528c4cc07401cdd7181018169baa00240ad14a08158c064c0b8c0acdd5000980c8044590291980b1bac302d006298009bab301e302b375400300380120308992cc004c090c0a8dd5000c566003300198009bab301e302b37540110038012030a50a5140a5133025301a3756605c00c66e9520023302d302e302b37546032603c60566ea8c0b8c0acdd5000a5eb8229410294590291980b1bac302d008298009bab301e302b3754603c60566ea800600700240608140dd7181598141baa001300d02f8b204c37586052605460540026052604c6ea8c0a4c098dd500198149814981498148009814001181300099198008009bac30260022259800800c5a264b30013375e6050604a6ea800401a26030604a6ea800626600600660520048118c09c00502518109baa012302200130223023001301e375400f16407080e0600200244464b30010038991919911980480119b8a48901280059800800c4cdc52441035b5d2900006899b8a489035b5f20009800800ccdc52441025d2900006914c00402a00530070014029229800805400a002805101520445980099b880014803a266e0120f2010018acc004cdc4000a41000513370066e01208014001480362c80e901d1bac301f002375a603a0026466ec0dd4180e8009ba7301e001375400713259800800c4cdc52441027b7d00003899b8a489037b5f20003232330010010032259800800c400e264b30010018994c00402a6044003337149101023a200098008054c08c00600a805100a181280144ca6002015302200199b8a489023a200098008054c08c006600e66008008004805100a181280120463025001408866e29220102207d00003407c6eac00e264b3001001899b8a489025b5d00003899b8a489035b5f20009800800ccdc52441015d00003914c00401e0053004001401d229800803c00a0028039012203e3758007133005375a0060051323371491102682700329800800ccdc01b8d0024800666e292210127000044004444b3001337100049000440062646645300100699b800054800666e2ccdc00012cc004cdc4001240291481822903720443371666e000056600266e2000520148a40c11481b9022002200c33706002901019b8600148080cdc7002001203e375c0068110dc5245022c2000301a301b0092232330010010032259800980a000c4cdc524410130000038acc004cdc4000a40011337149101012d0033002002337029000000c4cc018cdc2000a402866e2ccdc019b85001480512060003406480c88a4d1365640041&quot;;</span>
<span class="fc" id="L82">        return PlutusBlueprintUtil.getPlutusScriptFromCompiledCode(compiledCode, PlutusVersion.v3);</span>
    }


    public static PlutusScript getUVerifyStateContract() {
<span class="fc" id="L87">        String compiledCode = &quot;5912940101002229800aba2aba1aba0aab9faab9eaab9dab9a9bae0039bae002488888888966003300130053754015370e90034dc3a4001370e90022444464653001300a3754003300e00698070012444b30013006003899912cc004c024c03cdd5001c4c8c8c966002602e005133223322598009808000c566002602e6ea800e0051640611598009802000c566002602e6ea800e0051640611598009807800c566002602e6ea800e0051640611598009808800c566002602e6ea800e00516406115980099b87480200062b3001301737540070028b20308b202a405480a9015202a1330060032259800801466002602e6ea802e6e9520009180d980e000c88c8c8cc004004010896600200300389919912cc004cdc8803801456600266e3c01c00a20030064075133005005302300440746eb8c070004dd5980e800980f800a03a14bd6f7b63048c06cc070c070c070c070c070c070c070c070c070c070006460366038603860380032301b301c301c0019180d980e180e180e180e180e180e000c8c06cc070c070c070c07000644646600200200644b30010018a508acc004c00cc0780062946266004004603e00280c901c4dc0240052301b301c301c301c301c301c301c301c001911919800800801912cc00400629422b30013371e6eb8c07800400e2946266004004603e00280c901c48cdc4240006e340064b30010018a518a5040652301b301c301c301c301c301c301c301c301c001912cc004c048c060dd500144c8c8c8c8c8c8c8c8c8c8ca600264b300130250018acc004cdc4a4008604800316898091812000a0468b204c3754604e003375c604e017375c604e015375a604e013375a604e011375a604e00d375a604e00b375c604e009375a604e007375c604e00491111111112cc004c0c802e26603e6eb0c0c404489660020050188991801181a8019bae303300240c51640bc30270013026001302500130240013023001302200130210013020001301f001301e0013019375400516405d2301b301c301c301c301c301c001488888888888888888a6002605a025375860580252232330010010032259800800c5300103d87a80008992cc004c0100062602c6606000297ae089980180198190012058303000140b922323259800980d000c4c9660026036605a6ea8c054c0b8dd5180a98171baa005899b88001004899b8900100440b06eb4c0c0c0b4dd50014566002604a00314a114a2815902b18159baa001302e302b3754602460566ea800a44b30010018a40011300a33002002302f00140b12233008002001912cc0040062900044c028cc008008c0bc00502c4888c8cc88cc008008004896600200300389919912cc004cdc8803801456600266e3c01c00a200300640c1133005005303600440c06eb8c0bc004dd698180009819000a06033013004003148001222222229800981a8044dd6181a0044cc01801c8cdd7981a98191baa303530323754603260646ea8004cdd2a4004660686ea40bd2f5c130040049112cc0066002601e0054a14a281922b300132330010010032259800800c528c56600264b30013013375c6074606e6ea80062b30013013375c6034606e6ea80062660120086eb8c068c0dcdd5000c528206a8a5040d46072003133002002303a0018a5040d081ba266e3c00cdc9194c004006007489004004444b30010028800c66002007303b00299b8a0013232323371466e28cdc51bae303d00337306e64dd7181e8011bae303d001329800800cdd6181f181f80152201004004444b30010028800c66002007304100299b8a00137306e64dd71820001200640f8607a0026078002606e6ea8c0e800900320708a5040c914a08192600400522230219800801c00a002802122222229800981e181e003cdd6181d803d660026062606e6ea8016294629410364896600260666eb4c078c0e8dd5000c528c56600260666eb4c074c0e8dd5000c528c566003300130333370c60326eb4c070c0e8dd50009bad301e303a37540034a14a281c22946264660020026eb0c070c0ecdd5001112cc00400629462b3001323301d00525980099baf3025303e37540026e98c966002607000314bd6f7b63044c8c8cc0040052f5bded8c044b300100189982219bb04c01014000374c00697adef6c608994c004dd71821000cdd59821800cc11c0092225980099b904890000389982419bb04c01014000374c00e00b15980099b8f4890000389982419bb04c01014000374c00e003133048337606ea400cdd300119803003000a08841103045001410c646600200297adef6c602259800800c4cc10ccdd8261014000375000697adef6c608994c004dd71820800cdd69821000cc1180092225980099b904890000389982399bb04c01014000375000e00b15980099b8f4890000389982399bb04c01014000375000e003133047337606ea400cdd400119803003000a086410c3044001410881e8cdc19bad3021303e375400a60146eb0c07cc0f8dd5002c4cdd79820981f1baa3041303e3754002604c660806ea40092f5c114a081e0dd7181f800c4cc008008c100006294103a207a40e081c1038244446645300130410029bac30413042002cc0056600200314a314a081fa94294503c2444b300159800cc00400694294503f4528c56600200319800918151982219ba548008cc110dd4800a5eb80cc11130103d87a80004bd704c100dd5182218209baa03492cc004006298103d87a800089815198221822800a5eb81043489660020031480022604466004004608e0028221222233225980099b87480200162b300130403046375400513259800982018239baa0018992cc004c108c120dd5000c4c8c8c8c8c8c8c8ca60026eb4c1500066eb8c15001e6eb4c15001a6eb4c1500166eb0c1500126eb4c15000e6eb4c150009222222259800982e00444cc124dd6182d807912cc00400a26609600a44b30010028992cc004c158c170dd5000c5660026094602e04115980099b8f00b375c60c060ba6ea800626605e03c91011c11bcb8e4a79304e23bcd5e2bf628907f9b998f43902f41d1db439981008a50416d14a082da2c82d8c064c8cc004004080896600200314bd7044cc180c174c184004cc008008c18800505f44c8c008c18400cdd7182f80120ba8991801182f8019bae305d002416d16416430540013053001305200130510013050001304f001304e0013049375400316411c609660906ea80062c8230c128c12cc12cc11cdd5182518239baa0028b208a899912cc004c10c01e2b300130423048375400913259800982118249baa001899198120008992cc004c114c12cdd5000c4c966002608a60986ea80062646600c00226464b30013049304f3754003133225980099b87300c01533700002005159800981f801456600266e2400520028acc004cdc79bae3055305237540066eb8c154c148dd50044566002646606605246466e3cdc919b8a375c60b000330014a1480126eb4c160c1640057920033054375460ae60a86ea8004dd7182a98291baa0088acc004cdc4980e1bac30393052375408a6eb4c0b0c148dd500445660033001375c606060a46ea80226eb0c0e4c148dd5022c04d01d4566002b3001598009bac30553052375400b14a314a0829a294626605e6eb0c154c148dd50029bae30393052375401082822b30015980099b8f375c607260a46ea8020dd7181c98291baa008899baf323232303d33057305800333057305800233057303830553754010660ae607260aa6ea8020cc15cc0d8c154dd50041982b9816982a9baa00833057375066e00dd6981b982a9baa00848004cc15cc160004cc15cc0ccc154dd50041982b981e182a9baa00830593059305900130583058305830583058305800130570013052375401001114a082822b3001330170190088acc004cc098c0c0c148dd50231bad302a30523754011133024013375c607260a46ea80222941050452820a08a50414114a082822941050452820a08a50414114a082822941050452820a08a50414060380046038660120269000c5904e180600099803808a400460a0609a6ea80062c8258c0bcc130dd5181998261baa304f304c3754003164128660400324b30013375e609e60986ea8c0ccc130dd50009805824c660026eacc0ccc130dd5181998261baa001824cdd7182798281828182818281828182818281828182818261baa002405514a08250c134c128dd5000c5904818261826982698249baa304c3049375400916411d13259800982180444c966002608860946ea800626464b30013046304c375400313259800982318269baa001899198038008acc004cdc79bae3036304f3754002009159800980300544cc08404122011c11bcb8e4a79304e23bcd5e2bf628907f9b998f43902f41d1db439981008a50413514a08268c144c138dd5000c5904c181818269baa3034304d375460a0609a6ea80062c8258cc0840888c0ea60026eacc0d0c134dd5181a18269baa001825400901d1bae304e304b3754003164124600e6600601a9000c566002606e011132332259800982318261baa001899192cc004c120c138dd5000c4c9660026090609e6ea8006264660540022b30013370e601602800d159800998118091bae30383051375400315980099b8f004375c60a860a26ea80062b30019800981f18281baa3036305137540034a14a2827a2b3001302c3758607060a26ea81122b3001303e006898040064528209e8a50413d14a0827a294104f4528209e8a50413c60a660a06ea80062c8270c0c8c13cdd5181b18279baa3052304f3754003164134660460484607930013756606c609e6ea8c0d8c13cdd5000c13200480f8dd7182818269baa0018b2096301700130080013300300d4800629410482090259800982198249baa0018a508a514120823888c8cc00400400c896600200314bd7044ca60026eb8c12c0066eb4c13000660a00049112cc004cdc380380144cc144dd480199803003000c4cc01801800504d0c13800504c112cc004c108c120dd500144c8c8c8c8c8c8c8ca60026eb4c1500066eb8c15001e6eb4c15001a6eb4c1500166eb0c1500126eb4c15000e6eb4c150009222222259800982e00444cc124dd6182d807912cc00400a26609600a44b300100280a44c8c008c18400cdd7182f80120ba8991801182f8019bae305d002416d16416430540013053001305200130510013050001304f001304e0013049375400516411c8228cc06803096600266ebcc124c118dd50009802821c56600264660020026605a6eacc0b8c11cdd5001022112cc004006294226464b300133004004304e0038a518981b9bad304a00241206eb8c120004c12c00504946600330013756605a608c6ea8006087042403d4a14a2822229410444528208830010014528207e40fd159800cc00401e94294503f4528c56600200f159800981d18201baa00e8992cc004c0e8c104dd5000c4cc8966002607a00310048acc004c0c40062009159800981e000c4cc0740084c8c966002607e608a6ea800626464b3001304030473754003132330220011598009980d8051bae30303049375400f159800981b1809802c56600330013756606060926ea800e08d375c609860926ea801d0124566002b30013371090001bad302b3049375400f13301d00b375a604260926ea801e29410474566002b30019800981b18241baa302e3049375400f4a14a2823a266ebcc8c8c8c8c8c8c0dccc144c148018cc144c148014cc144c148010cc144c14800ccc144c148008cc144c148004cc144dd419b80375a6062609e6ea8035200133051302d304f375400e60a660a660a600260a400260a200260a0002609e002609c00260926ea801c006294104745660026601c02000315980099b8930133758606060926ea80f0dd6981198249baa0018cc004dd7181398249baa0019bac30303049375407900a405114a0823a29410474528208e8a50411d14a0823a29410474528208e304b304837540031641186054608e6ea8004c124c118dd5000c590442cc004006298103d87a800089816998239824000a5eb810461919800800806112cc004006297ae0899912cc004c966002606c60906ea8006266e3c118dd7182618249baa0018a50411c609660906ea8c12cc120dd500144cc128008cc0100100062660080080028230c124004c1280050474528208441088210c114c108dd500098209baa30453042375406b164100604860826ea8c0a0c104dd5182218209baa00e8b207e8a5040fc81fa294103f0c100c100c100010cc088dd5981f80201c844c9660026022602e6ea800626464653001375c603c003301f0019bae301e0039b99375c603c00491112cc004c08c00e2660206eb0c08800c89660020051300b302500c899180118130019b99375c604800481122c8100603c002603a00260306ea80062c80b0c068009018180a1baa001370e9001180b001c590141bac30150013015001301037540071640386022601c6ea801088c8cc00400400c88cc00c004c00800a2b30013008003899192cc004c024c03cdd51809980a0014528c5900e1bad3012001300e37540091640308060601a601c002601a0088a4d13656400c1&quot;;</span>
<span class="fc" id="L88">        return PlutusBlueprintUtil.getPlutusScriptFromCompiledCode(compiledCode, PlutusVersion.v3);</span>
    }

    public static PlutusScript getLibraryContract() {
<span class="fc" id="L92">        String compiledCode = &quot;589f010100229800aba2aba1aab9faab9eaab9dab9a9bae002488888896600264646644b30013370e900118039baa0018994c004c02c006601660180032259800800c528456600266e3cdd718068008044528c4cc008008c03800500920184888cc004004dd618071807980798079807980798079807980798061baa300e00818041baa0018b200c300800130083009001300800130043754011149a26cac80101&quot;;</span>
<span class="fc" id="L93">        return PlutusBlueprintUtil.getPlutusScriptFromCompiledCode(compiledCode, PlutusVersion.v3);</span>
    }

    public static PlutusScript getLibraryContract(String paymentCredential) {
<span class="fc" id="L97">        PlutusScript plainScript = getLibraryContract();</span>

<span class="fc" id="L99">        String parameterizedScript = ScalusScriptUtils.applyParamsToScript(plainScript.getCborHex(),</span>
<span class="fc" id="L100">                BytesPlutusData.of(paymentCredential));</span>
<span class="fc" id="L101">        return PlutusV3Script.builder().cborHex(parameterizedScript).build();</span>
    }

    public static PlutusScript getUVerifyStateContract(String scriptHash, String proxyTokenName) {
<span class="fc" id="L105">        PlutusScript plainScript = getUVerifyStateContract();</span>

<span class="fc" id="L107">        String parameterizedScript = ScalusScriptUtils.applyParamsToScript(plainScript.getCborHex(),</span>
<span class="fc" id="L108">                BytesPlutusData.of(HexUtil.decodeHexString(scriptHash)),</span>
<span class="fc" id="L109">                BytesPlutusData.of(HexUtil.decodeHexString(proxyTokenName)));</span>
<span class="fc" id="L110">        return PlutusV3Script.builder().cborHex(parameterizedScript).build();</span>
    }

    public static PlutusScript getUVerifyStateContract(String txHash, int outputIndex) {
<span class="fc" id="L114">        PlutusScript proxyContract = getUverifyProxyContract(txHash, outputIndex);</span>
<span class="fc" id="L115">        String proxyScriptHash = validatorToScriptHash(proxyContract);</span>

<span class="pc bpc" id="L117" title="1 of 2 branches missed.">        if (proxyScriptHash == null) {</span>
<span class="nc" id="L118">            throw new IllegalArgumentException(&quot;Script hash of proxy contract is null&quot;);</span>
        }

<span class="fc" id="L121">        String proxyTokenName = getProxyStateTokenName(txHash, outputIndex);</span>

<span class="fc" id="L123">        PlutusScript plainScript = getUVerifyStateContract();</span>

<span class="fc" id="L125">        String parameterizedScript = ScalusScriptUtils.applyParamsToScript(plainScript.getCborHex(),</span>
<span class="fc" id="L126">                BytesPlutusData.of(HexUtil.decodeHexString(proxyScriptHash)),</span>
<span class="fc" id="L127">                BytesPlutusData.of(HexUtil.decodeHexString(proxyTokenName)));</span>
<span class="fc" id="L128">        return PlutusV3Script.builder().cborHex(parameterizedScript).build();</span>
    }

    public static PlutusScript getUverifyProxyContract(Utxo utxo) {
<span class="fc" id="L132">        return getUverifyProxyContract(utxo.getTxHash(), utxo.getOutputIndex());</span>
    }

    public static PlutusScript getUverifyProxyContract(String txHash, int outputIndex) {
<span class="fc" id="L136">        PlutusScript plainScript = getUVerifyProxyContract();</span>

<span class="fc" id="L138">        PlutusData outputReference = ConstrPlutusData.of(0,</span>
<span class="fc" id="L139">                BytesPlutusData.of(HexUtil.decodeHexString(txHash)),</span>
<span class="fc" id="L140">                BigIntPlutusData.of(outputIndex));</span>


<span class="fc" id="L143">        String parameterizedScript = ScalusScriptUtils.applyParamsToScript(plainScript.getCborHex(), outputReference);</span>
<span class="fc" id="L144">        return PlutusV3Script.builder().cborHex(parameterizedScript).build();</span>
    }

    public static String getMintOrBurnAuthTokenHash(CardanoNetwork network) {
<span class="pc bpc" id="L148" title="1 of 2 branches missed.">        if (network.equals(CardanoNetwork.MAINNET)) {</span>
<span class="nc" id="L149">            return &quot;a8172157733dd50ef6f0f8d38e361745037f0a79c1f5da9b1d8079ff&quot;;</span>
        }
<span class="fc" id="L151">        return &quot;d3c25617941168e238038f1cf6542229b919bbd6fd2b8292ce176203&quot;;</span>
    }

    public static String getMintStateTokenCode(CardanoNetwork network) {
<span class="nc bnc" id="L155" title="All 2 branches missed.">        if (network.equals(CardanoNetwork.MAINNET)) {</span>
<span class="nc" id="L156">            return &quot;590b9301010032323232323232253330023232323232533233008300130093754004264646464646464a666024602a004264646464646464646464a666032601a012264646464646464646464646464646464646464646464a66605e60466030002264a666060605260626ea80044c94ccc0c4c094c0740184c94ccc0c8c0acc0ccdd500089919299981a19b8748010c0d4dd5000899299981a9817181b1baa00113232323232323232323232323232323232323232533304c304f00213302b01322533304e00213302d0092253330500021533304d304133302837566064609e6ea8c0c8c13cdd500da451ca8172157733dd50ef6f0f8d38e361745037f0a79c1f5da9b1d8079ff00375c606a609e6ea806454ccc134cdd7981898279baa3031304f37546064609e6ea806ccdd2a4004660a298011e581ca8172157733dd50ef6f0f8d38e361745037f0a79c1f5da9b1d8079ff004bd70099299982729998271823981b8008a5113303400101e132533304f3043303b001132533305030493051375400226464a6660a466e1d200430533754002264a6660a6609860a86ea80044c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c94ccc1b8c1c40084cc13402c894ccc1c00084cc13c01c894ccc1c800854ccc1bccdc781f9bae30543071375403a2a6660de60c66660946eacc150c1c4dd500f83381f8a99983799baf30533071375460a660e26ea807ccdd2a4004660e6609260e26ea80752f5c02a6660de664464a6660e460cc60e66ea80044c94ccc1ccc19cc1d0dd5182c183a9baa305830753754008266e2000400c4cdc48008019bad3077307437540022940c154c1ccdd5182b18399baa0023048307137540d86eb4c120c1c4dd500e8a999837a99983799b8f375c60a860e26ea80740fc54ccc1bccdc79bae30573071375403a6eb8c150c1c4dd501d8a99983799b8f375c609260e26ea8074dd7182498389baa03b1533306f3370e6eb4c190c1c4dd500e9bad3064307137540762a6660de66e1cdd6982698389baa01d375a609a60e26ea80ec54ccc1bccdd7982718389baa01d304e307137540762a6660de66e1cdd6982418389baa01d375a609060e26ea80ec54ccc1bccdc39bad304f3071375403a6eb4c140c1c4dd501d8a99983799b8f375c60e860ea60ea60ea60ea60ea60ea60ea60ea60ea60ea60ea60e26ea8074dd7182b98389baa03b13370e6eb4c158c1c4dd500e99b80375a60ac60e26ea80ed200114a029405280a5014a029405280a5014a02a6660de66e24c16cdd6182818389baa01d375a609e60e26ea807454ccc1bcc8cc004004dd6182898391baa01e22533307400114a2264a6660e464a6660e660ac6eb8c15cc1d4dd50008a999839982b1bae305b307537540022660b26eb0c168c1d4dd50381bae305b307537540022940528183b8010998018018008a5030770011533306f533306f3068375a609a60e26ea80745288a99983798341bad30643071375403a294454ccc1bcccc1bcc1a0cdc3182e9bad30563071375403a6eb4c134c1c4dd500ea504a229444c8cc004004dd6182798391baa01e22533307400114a2264a6660e464660a008c4a6660e866ebcc164c1d8dd50009ba6325333075306e00114bd6f7b6300991919800800a5eb7bdb180894ccc1ec0044cc1f0cdd82601014000374c00697adef6c60132323232533307c3372091010000213308001337609801014000374c00e00a2a6660f866e3d2210000213308001337609801014000374c00e0062661000266ec0dd48011ba600133006006003375660fa0066eb8c1ec008c1fc008c1f4004c8cc0040052f5bded8c044a6660f40022660f666ec13001014000375000697adef6c60132323232533307b3372091010000213307f337609801014000375000e00a2a6660f666e3d2210000213307f337609801014000375000e0062660fe66ec0dd48011ba800133006006003375a60f80066eb8c1e8008c1f8008c1f0004cdc19bad30693076375404460ba6eb0c14cc1d8dd5011099baf30583076375460b060ec6ea8004c1accc1e0dd480125eb805281bae307700213300300300114a060ee0022646609a08e464646466e3cdc919b8a0023337929412004001005375a60f060f20046eb8c1dc004c1ccdd5182a98399baa001375c60a660e26ea80745280a5014a029405280a5014a029404c94ccc1c0c1a4c1c4dd500089919191919191919299983d983f00109982d00091299983e8010980618400080689918011840808019b99375c60fe0042c6eb0c1f0004c1f0008dd7183d000983d0011b99375c60f000260f00046eb8c1d8004c1c8dd50008b183a0010991801183a0019bae307200216375c60de00260de0046eb4c1b4004c1b4008dd6183580098358011bad30690013069002375a60ce00260ce0046eb0c194004c194008dd6983180098318011bad30610013061002375c60be00260be0046eb8c174004c174008dd7182d800982d8011bae3059001305537540022c60ae60a86ea800458c0e4c14cdd5000982a98291baa00116302b001163303d021233304f3375e606e60a26ea800530103d87980004a094458dd6181898279baa019161613230023054003375c60a4004264600460a40066eb8c14000858dd6982680098268011bad304b001304b002375a609200260920046eb0c11c004c11c008dd6982280098228011bad30430013043002375c608200260820046eb8c0fc004c0fc008dd7181e800981e8011bac303b001303737540022c6072606c6ea800458c06cc0d4dd5180c181a9baa0013037303437540022c601a00c2c6eb8c0d4c0c8dd50008b180d0008b1bac30333034303430343034303430340023758606400260640046eb0c0c0004c0c0008dd6181700098151baa0252302d302e302e302e302e302e302e302e0012302c302d302d302d001222325333029301d302a37540022900009bad302e302b375400264a666052603a60546ea80045300103d87a8000132330010013756605e60586ea8008894ccc0b8004530103d87a8000132323232533302f337220100042a66605e66e3c0200084c098cc0ccdd4000a5eb80530103d87a8000133006006003375a60600066eb8c0b8008c0c8008c0c0004cc07800c00894ccc0a0004530103d87a80001301c33029302a0014bd701119198008008019129998150008a5013253330283004302d00214a2266006006002605a00246050605260526052605260520024604e6050605060506050605060500024604c604e604e604e604e604e604e604e604e604e604e0024604a604c604c604c604c604c604c604c604c604c00244646600200200644660060026004004466e212000371a0024604400246042604400244646600200200644a66604200229404c94ccc07ccdc79bae302400200414a226600600600260480024603e604060406040604060406040604060400022a66603266e1d200100913232533301b301430073300a37586040004466603866ebcc010c078dd5000a60103d87980004a094454ccc06cc03cc0100044c94ccc070c054c074dd5000899b8f00d375c6042603c6ea800458c0180045858dd6180f981018101810181018101810000980f980f980d9baa016162301e301f301f001300100122533301b0011480004c018cc008008c07800494ccc0640045300103d87a80001300d3301a301b0014bd70180080091299980c0008a4000260066600400460360026e01200222323300100100322533301800114bd7009919299980b980280109980d80119802002000899802002000980e001180d0009bad3012002375c60200022c602600264a66601c6004601e6ea800452f5bded8c026eacc04cc040dd5000998019bab3002300f375401400a6e1d200223011301230123012301200122323300100100322533301100114c103d87a800013232323253330123372200e0042a66602466e3c01c0084c024cc058dd3000a5eb80530103d87a8000133006006003375660260066eb8c044008c054008c04c004dd2a40006eb8c034c028dd50011b874800058c02cc030008c028004c028008c020004c010dd50008a4c26cacae6955ceaab9e5573eae815d0aba21&quot;;</span>
        }
<span class="nc" id="L158">        return &quot;590b9301010032323232323232253330023232323232533233008300130093754004264646464646464a666024602a004264646464646464646464a666032601a012264646464646464646464646464646464646464646464a66605e60466030002264a666060605260626ea80044c94ccc0c4c094c0740184c94ccc0c8c0acc0ccdd500089919299981a19b8748010c0d4dd5000899299981a9817181b1baa00113232323232323232323232323232323232323232533304c304f00213302b01322533304e00213302d0092253330500021533304d304133302837566064609e6ea8c0c8c13cdd500da451cd3c25617941168e238038f1cf6542229b919bbd6fd2b8292ce17620300375c606a609e6ea806454ccc134cdd7981898279baa3031304f37546064609e6ea806ccdd2a4004660a298011e581cd3c25617941168e238038f1cf6542229b919bbd6fd2b8292ce176203004bd70099299982729998271823981b8008a5113303400101e132533304f3043303b001132533305030493051375400226464a6660a466e1d200430533754002264a6660a6609860a86ea80044c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c94ccc1b8c1c40084cc13402c894ccc1c00084cc13c01c894ccc1c800854ccc1bccdc781f9bae30543071375403a2a6660de60c66660946eacc150c1c4dd500f83381f8a99983799baf30533071375460a660e26ea807ccdd2a4004660e6609260e26ea80752f5c02a6660de664464a6660e460cc60e66ea80044c94ccc1ccc19cc1d0dd5182c183a9baa305830753754008266e2000400c4cdc48008019bad3077307437540022940c154c1ccdd5182b18399baa0023048307137540d86eb4c120c1c4dd500e8a999837a99983799b8f375c60a860e26ea80740fc54ccc1bccdc79bae30573071375403a6eb8c150c1c4dd501d8a99983799b8f375c609260e26ea8074dd7182498389baa03b1533306f3370e6eb4c190c1c4dd500e9bad3064307137540762a6660de66e1cdd6982698389baa01d375a609a60e26ea80ec54ccc1bccdd7982718389baa01d304e307137540762a6660de66e1cdd6982418389baa01d375a609060e26ea80ec54ccc1bccdc39bad304f3071375403a6eb4c140c1c4dd501d8a99983799b8f375c60e860ea60ea60ea60ea60ea60ea60ea60ea60ea60ea60ea60e26ea8074dd7182b98389baa03b13370e6eb4c158c1c4dd500e99b80375a60ac60e26ea80ed200114a029405280a5014a029405280a5014a02a6660de66e24c16cdd6182818389baa01d375a609e60e26ea807454ccc1bcc8cc004004dd6182898391baa01e22533307400114a2264a6660e464a6660e660ac6eb8c15cc1d4dd50008a999839982b1bae305b307537540022660b26eb0c168c1d4dd50381bae305b307537540022940528183b8010998018018008a5030770011533306f533306f3068375a609a60e26ea80745288a99983798341bad30643071375403a294454ccc1bcccc1bcc1a0cdc3182e9bad30563071375403a6eb4c134c1c4dd500ea504a229444c8cc004004dd6182798391baa01e22533307400114a2264a6660e464660a008c4a6660e866ebcc164c1d8dd50009ba6325333075306e00114bd6f7b6300991919800800a5eb7bdb180894ccc1ec0044cc1f0cdd82601014000374c00697adef6c60132323232533307c3372091010000213308001337609801014000374c00e00a2a6660f866e3d2210000213308001337609801014000374c00e0062661000266ec0dd48011ba600133006006003375660fa0066eb8c1ec008c1fc008c1f4004c8cc0040052f5bded8c044a6660f40022660f666ec13001014000375000697adef6c60132323232533307b3372091010000213307f337609801014000375000e00a2a6660f666e3d2210000213307f337609801014000375000e0062660fe66ec0dd48011ba800133006006003375a60f80066eb8c1e8008c1f8008c1f0004cdc19bad30693076375404460ba6eb0c14cc1d8dd5011099baf30583076375460b060ec6ea8004c1accc1e0dd480125eb805281bae307700213300300300114a060ee0022646609a08e464646466e3cdc919b8a0023337929412004001005375a60f060f20046eb8c1dc004c1ccdd5182a98399baa001375c60a660e26ea80745280a5014a029405280a5014a029404c94ccc1c0c1a4c1c4dd500089919191919191919299983d983f00109982d00091299983e8010980618400080689918011840808019b99375c60fe0042c6eb0c1f0004c1f0008dd7183d000983d0011b99375c60f000260f00046eb8c1d8004c1c8dd50008b183a0010991801183a0019bae307200216375c60de00260de0046eb4c1b4004c1b4008dd6183580098358011bad30690013069002375a60ce00260ce0046eb0c194004c194008dd6983180098318011bad30610013061002375c60be00260be0046eb8c174004c174008dd7182d800982d8011bae3059001305537540022c60ae60a86ea800458c0e4c14cdd5000982a98291baa00116302b001163303d021233304f3375e606e60a26ea800530103d87980004a094458dd6181898279baa019161613230023054003375c60a4004264600460a40066eb8c14000858dd6982680098268011bad304b001304b002375a609200260920046eb0c11c004c11c008dd6982280098228011bad30430013043002375c608200260820046eb8c0fc004c0fc008dd7181e800981e8011bac303b001303737540022c6072606c6ea800458c06cc0d4dd5180c181a9baa0013037303437540022c601a00c2c6eb8c0d4c0c8dd50008b180d0008b1bac30333034303430343034303430340023758606400260640046eb0c0c0004c0c0008dd6181700098151baa0252302d302e302e302e302e302e302e302e0012302c302d302d302d001222325333029301d302a37540022900009bad302e302b375400264a666052603a60546ea80045300103d87a8000132330010013756605e60586ea8008894ccc0b8004530103d87a8000132323232533302f337220100042a66605e66e3c0200084c098cc0ccdd4000a5eb80530103d87a8000133006006003375a60600066eb8c0b8008c0c8008c0c0004cc07800c00894ccc0a0004530103d87a80001301c33029302a0014bd701119198008008019129998150008a5013253330283004302d00214a2266006006002605a00246050605260526052605260520024604e6050605060506050605060500024604c604e604e604e604e604e604e604e604e604e604e0024604a604c604c604c604c604c604c604c604c604c00244646600200200644660060026004004466e212000371a0024604400246042604400244646600200200644a66604200229404c94ccc07ccdc79bae302400200414a226600600600260480024603e604060406040604060406040604060400022a66603266e1d200100913232533301b301430073300a37586040004466603866ebcc010c078dd5000a60103d87980004a094454ccc06cc03cc0100044c94ccc070c054c074dd5000899b8f00d375c6042603c6ea800458c0180045858dd6180f981018101810181018101810000980f980f980d9baa016162301e301f301f001300100122533301b0011480004c018cc008008c07800494ccc0640045300103d87a80001300d3301a301b0014bd70180080091299980c0008a4000260066600400460360026e01200222323300100100322533301800114bd7009919299980b980280109980d80119802002000899802002000980e001180d0009bad3012002375c60200022c602600264a66601c6004601e6ea800452f5bded8c026eacc04cc040dd5000998019bab3002300f375401400a6e1d200223011301230123012301200122323300100100322533301100114c103d87a800013232323253330123372200e0042a66602466e3c01c0084c024cc058dd3000a5eb80530103d87a8000133006006003375660260066eb8c044008c054008c04c004dd2a40006eb8c034c028dd50011b874800058c02cc030008c028004c028008c020004c010dd50008a4c26cacae6955ceaab9e5573eae815d0aba21&quot;;</span>
    }

    public static String getMintStateTokenHash(CardanoNetwork network) {
<span class="pc bpc" id="L162" title="1 of 2 branches missed.">        if (network.equals(CardanoNetwork.MAINNET)) {</span>
<span class="nc" id="L163">            return &quot;1919c122cba719a9bf760e4e463bbcf8a3d46327569cdb5edd8b7d0e&quot;;</span>
        }
<span class="fc" id="L165">        return &quot;6b3a786359bfb307baa3be8cc4fa9872c219c42b76226a4f97d90a62&quot;;</span>
    }

    public static String getUpdateStateTokenCode(CardanoNetwork network) {
<span class="nc bnc" id="L169" title="All 2 branches missed.">        if (network.equals(CardanoNetwork.MAINNET)) {</span>
<span class="nc" id="L170">            return &quot;590b3a01010032323232323232253330023232323232533233008300130093754004264646646464646464646464646464646464646464646464646464646446464a66604e600e60506ea80044c8c94ccc0a4cdc3a400860546ea80044c8cc02400454ccc0a8c08cc060dd6181018161baa0271533302a3375e60106eb0c080c0b0dd5013980919817180f98161baa0014bd700a99981518119998039bab301f302c3754603e60586ea800d2211c1919c122cba719a9bf760e4e463bbcf8a3d46327569cdb5edd8b7d0e00375c603e60586ea80044c8c94ccc0b0c0940044c8c94ccc0b8c038c0bcdd50008992999817981418088028992999818180818189baa00113253330313375e604860666ea8004c090c0ccdd5181318199baa00313253330323370e900218199baa0011323301200115333033302c33301037566050606a6ea800d22011c1919c122cba719a9bf760e4e463bbcf8a3d46327569cdb5edd8b7d0e00375c6050606a6ea80284c8c94ccc0d4c94ccc0d8cdc4240006eb4c0b0c0e0dd500689919299981c1818981c9baa00113253330393032303a3754605c60766ea8c0b8c0ecdd5002099b880010031337120020066eb4c0f4c0e8dd50008a50302a30393754605860726ea8008dd6980d181c1baa00d14a06032606e6ea80c854ccc0d400854ccc0d400454ccc0d4cdc4980b9bac301a303737540066eb4c06cc0dcdd5001899198008009bac301b3038375400844a66607400229444c94ccc0e0c94ccc0e4c0acdd71816181d9baa00115333039302b375c605a60766ea80044c8c8cc004004dd61818981e9baa03822533303f00114a0264a66607a66e3cdd718210010020a511330030030013042001375c605a60766ea80045280a50303d00213300300300114a0607a00229405280a5014a0a66606860286eb4c07cc0d8dd50010a51153330343014375a603c606c6ea80085288a99981a19981a180a19b863024375a6054606c6ea8008dd6980f981b1baa0024a0944528899198008009bac30213037375400644a66607200229444c94ccc0dcc8c8cc004004034894ccc0f4004528099299981d99299981e19baf3031303e37540026e98c94ccc0f4c07400452f5bded8c0264646600200297adef6c60225333043001133044337609801014000374c00697adef6c60132323232533304433720910100002133048337609801014000374c00e00a2a66608866e3d22100002133048337609801014000374c00e00626609066ec0dd48011ba6001330060060033756608a0066eb8c10c008c11c008c114004c8cc0040052f5bded8c044a66608400226608666ec13001014000375000697adef6c60132323232533304333720910100002133047337609801014000375000e00a2a66608666e3d22100002133047337609801014000375000e00626608e66ec0dd48011ba800133006006003375a60880066eb8c108008c118008c110004cdc19bad3026303e375401460546eb0c0a0c0f8dd5005099baf302f303e3754605e607c6ea8004c090cc100dd4802a5eb8052818200010a511330030030013040001375c60780042660060060022940c0f00054ccc0cccdc79bae3026303537540026eb8c098c0d4dd50050a99981999b8f375c6050606a6ea8004dd71814181a9baa00a153330333371e6eb8c09cc0d4dd50009bae3027303537540142a66606666e3cdd7180e181a9baa001375c6038606a6ea802854ccc0cccdc39bad301d303537540026eb4c074c0d4dd50050a99981999b87375a603c606a6ea8004dd6980f181a9baa00a153330333375e603e606a6ea8004c07cc0d4dd50050a99981999b87375a602e606a6ea8004dd6980b981a9baa00a153330333370e6eb4c064c0d4dd50009bad3019303537540142a66606666e3cdd71810181a9baa001375c6040606a6ea80284cdc39bad30293035375400266e00dd69814981a9baa00a480045280a5014a029405280a5014a029405280a50163037303437540022c604a60666ea800458c0d4c0c8dd50008b29998190028a60103d87a8000130173303330340054bd700b181998181baa001163300e37586040605e6ea80a8024dd618189819181918171baa0291533302c300c0011533302c300c300e0021533302c3025301a37586044605c6ea80a44c94ccc0b4c034c0b8dd500089919192999819981b001099299981899b87375a606600490008a99981899b8f00100413371e6eb8c098c0ccdd50040020a5014a06eb8c0c400458c0d0004c94ccc0bcc0a0c0c0dd50008a5eb7bdb1804dd5981a18189baa001330153756603060606ea80ad22011c1919c122cba719a9bf760e4e463bbcf8a3d46327569cdb5edd8b7d0e00375c6064605e6ea800458c028dd6181118171baa0291614a02c646600200200e44a6660600022900009991299981798141998061bab30243031375400491011c1919c122cba719a9bf760e4e463bbcf8a3d46327569cdb5edd8b7d0e00375c604860626ea80184c07c0044004c0c8004cc008008c0cc004c8cc004004018894ccc0bc00452f5c026464a66605c66605c66ebcc088c0c0dd500126103d87980004a09444cc0c8008cc0100100044cc010010004c0cc008c0c4004585858c0b8c0acdd50008b180e18151baa301d302a3754002605860526ea800458cc01cdd6180c98141baa0230023758605460566056604e6ea8088888c94ccc09cc080c0a0dd50008a400026eb4c0b0c0a4dd5000992999813981018141baa00114c103d87a8000132330010013756605a60546ea8008894ccc0b0004530103d87a8000132323232533302d337220100042a66605a66e3c0200084c054cc0c4dd4000a5eb80530103d87a8000133006006003375a605c0066eb8c0b0008c0c0008c0b8004cc03400c00894ccc098004530103d87a80001300b3302730280014bd70112999811980198121baa0021323232323232323232323232323232323232323232323232533303e304100213302c00b22533304000213302e0072253330420021501d132533304030203041375400226464646464646464a666096609c00426607200244a66609a0042601860a001a264600460a20066e64dd718278010b1bac304c001304c002375c609400260940046e64dd7182400098240011bae3046001304237540022c6088004264600460880066eb8c10800858dd7181f800981f8011bad303d001303d0023758607600260760046eb4c0e4004c0e4008dd6981b800981b8011bac30350013035002375a606600260660046eb4c0c4004c0c4008dd7181780098178011bae302d001302d002375c605600260560046eb8c0a4004c094dd50010b1b874800088c8cc00400400c894ccc098004530103d87a80001323253330253375e6030604e6ea80080144c034cc0a40092f5c026600800800260540046050002600200244a6660440022900009807998010011812800918111811981198119811981198119811800918109811181118111811181118111811181118110009181018109810981098109810981098109810981098108009119198008008019129998100008a6103d87a800013232323253330213372200e0042a66604266e3c01c0084c024cc094dd3000a5eb80530103d87a8000133006006003375660440066eb8c080008c090008c088004dd2a40004603a603c603c603c00246038603a603a603a603a0024603660386038603860386038002460346036603660366036603660360024603260346034603460346034603460346034603460346034002600200244a66602c002290000980199801001180c8009b804800888c8cc00400400c88cc00c004c0080088cdc4240006e340048c04c0048c048c04cc04c0048c044c0480048c040c044c044c044c044c044c044c044c044004c03c008c038c03c004c028dd50011b874800858c02cc030008c028004c028008c020004c010dd50008a4c26cacae6955ceaab9e5573eae815d0aba21&quot;;</span>
        }
<span class="nc" id="L172">        return &quot;590b3a01010032323232323232253330023232323232533233008300130093754004264646646464646464646464646464646464646464646464646464646446464a66604e600e60506ea80044c8c94ccc0a4cdc3a400860546ea80044c8cc02400454ccc0a8c08cc060dd6181018161baa0271533302a3375e60106eb0c080c0b0dd5013980919817180f98161baa0014bd700a99981518119998039bab301f302c3754603e60586ea800d2211c6b3a786359bfb307baa3be8cc4fa9872c219c42b76226a4f97d90a6200375c603e60586ea80044c8c94ccc0b0c0940044c8c94ccc0b8c038c0bcdd50008992999817981418088028992999818180818189baa00113253330313375e604860666ea8004c090c0ccdd5181318199baa00313253330323370e900218199baa0011323301200115333033302c33301037566050606a6ea800d22011c6b3a786359bfb307baa3be8cc4fa9872c219c42b76226a4f97d90a6200375c6050606a6ea80284c8c94ccc0d4c94ccc0d8cdc4240006eb4c0b0c0e0dd500689919299981c1818981c9baa00113253330393032303a3754605c60766ea8c0b8c0ecdd5002099b880010031337120020066eb4c0f4c0e8dd50008a50302a30393754605860726ea8008dd6980d181c1baa00d14a06032606e6ea80c854ccc0d400854ccc0d400454ccc0d4cdc4980b9bac301a303737540066eb4c06cc0dcdd5001899198008009bac301b3038375400844a66607400229444c94ccc0e0c94ccc0e4c0acdd71816181d9baa00115333039302b375c605a60766ea80044c8c8cc004004dd61818981e9baa03822533303f00114a0264a66607a66e3cdd718210010020a511330030030013042001375c605a60766ea80045280a50303d00213300300300114a0607a00229405280a5014a0a66606860286eb4c07cc0d8dd50010a51153330343014375a603c606c6ea80085288a99981a19981a180a19b863024375a6054606c6ea8008dd6980f981b1baa0024a0944528899198008009bac30213037375400644a66607200229444c94ccc0dcc8c8cc004004034894ccc0f4004528099299981d99299981e19baf3031303e37540026e98c94ccc0f4c07400452f5bded8c0264646600200297adef6c60225333043001133044337609801014000374c00697adef6c60132323232533304433720910100002133048337609801014000374c00e00a2a66608866e3d22100002133048337609801014000374c00e00626609066ec0dd48011ba6001330060060033756608a0066eb8c10c008c11c008c114004c8cc0040052f5bded8c044a66608400226608666ec13001014000375000697adef6c60132323232533304333720910100002133047337609801014000375000e00a2a66608666e3d22100002133047337609801014000375000e00626608e66ec0dd48011ba800133006006003375a60880066eb8c108008c118008c110004cdc19bad3026303e375401460546eb0c0a0c0f8dd5005099baf302f303e3754605e607c6ea8004c090cc100dd4802a5eb8052818200010a511330030030013040001375c60780042660060060022940c0f00054ccc0cccdc79bae3026303537540026eb8c098c0d4dd50050a99981999b8f375c6050606a6ea8004dd71814181a9baa00a153330333371e6eb8c09cc0d4dd50009bae3027303537540142a66606666e3cdd7180e181a9baa001375c6038606a6ea802854ccc0cccdc39bad301d303537540026eb4c074c0d4dd50050a99981999b87375a603c606a6ea8004dd6980f181a9baa00a153330333375e603e606a6ea8004c07cc0d4dd50050a99981999b87375a602e606a6ea8004dd6980b981a9baa00a153330333370e6eb4c064c0d4dd50009bad3019303537540142a66606666e3cdd71810181a9baa001375c6040606a6ea80284cdc39bad30293035375400266e00dd69814981a9baa00a480045280a5014a029405280a5014a029405280a50163037303437540022c604a60666ea800458c0d4c0c8dd50008b29998190028a60103d87a8000130173303330340054bd700b181998181baa001163300e37586040605e6ea80a8024dd618189819181918171baa0291533302c300c0011533302c300c300e0021533302c3025301a37586044605c6ea80a44c94ccc0b4c034c0b8dd500089919192999819981b001099299981899b87375a606600490008a99981899b8f00100413371e6eb8c098c0ccdd50040020a5014a06eb8c0c400458c0d0004c94ccc0bcc0a0c0c0dd50008a5eb7bdb1804dd5981a18189baa001330153756603060606ea80ad22011c6b3a786359bfb307baa3be8cc4fa9872c219c42b76226a4f97d90a6200375c6064605e6ea800458c028dd6181118171baa0291614a02c646600200200e44a6660600022900009991299981798141998061bab30243031375400491011c6b3a786359bfb307baa3be8cc4fa9872c219c42b76226a4f97d90a6200375c604860626ea80184c07c0044004c0c8004cc008008c0cc004c8cc004004018894ccc0bc00452f5c026464a66605c66605c66ebcc088c0c0dd500126103d87980004a09444cc0c8008cc0100100044cc010010004c0cc008c0c4004585858c0b8c0acdd50008b180e18151baa301d302a3754002605860526ea800458cc01cdd6180c98141baa0230023758605460566056604e6ea8088888c94ccc09cc080c0a0dd50008a400026eb4c0b0c0a4dd5000992999813981018141baa00114c103d87a8000132330010013756605a60546ea8008894ccc0b0004530103d87a8000132323232533302d337220100042a66605a66e3c0200084c054cc0c4dd4000a5eb80530103d87a8000133006006003375a605c0066eb8c0b0008c0c0008c0b8004cc03400c00894ccc098004530103d87a80001300b3302730280014bd70112999811980198121baa0021323232323232323232323232323232323232323232323232533303e304100213302c00b22533304000213302e0072253330420021501d132533304030203041375400226464646464646464a666096609c00426607200244a66609a0042601860a001a264600460a20066e64dd718278010b1bac304c001304c002375c609400260940046e64dd7182400098240011bae3046001304237540022c6088004264600460880066eb8c10800858dd7181f800981f8011bad303d001303d0023758607600260760046eb4c0e4004c0e4008dd6981b800981b8011bac30350013035002375a606600260660046eb4c0c4004c0c4008dd7181780098178011bae302d001302d002375c605600260560046eb8c0a4004c094dd50010b1b874800088c8cc00400400c894ccc098004530103d87a80001323253330253375e6030604e6ea80080144c034cc0a40092f5c026600800800260540046050002600200244a6660440022900009807998010011812800918111811981198119811981198119811800918109811181118111811181118111811181118110009181018109810981098109810981098109810981098108009119198008008019129998100008a6103d87a800013232323253330213372200e0042a66604266e3c01c0084c024cc094dd3000a5eb80530103d87a8000133006006003375660440066eb8c080008c090008c088004dd2a40004603a603c603c603c00246038603a603a603a603a0024603660386038603860386038002460346036603660366036603660360024603260346034603460346034603460346034603460346034002600200244a66602c002290000980199801001180c8009b804800888c8cc00400400c88cc00c004c0080088cdc4240006e340048c04c0048c048c04cc04c0048c044c0480048c040c044c044c044c044c044c044c044c044004c03c008c038c03c004c028dd50011b874800858c02cc030008c028004c028008c020004c010dd50008a4c26cacae6955ceaab9e5573eae815d0aba21&quot;;</span>
    }

    public static String getUpdateStateTokenHash(CardanoNetwork network) {
<span class="nc bnc" id="L176" title="All 2 branches missed.">        if (network.equals(CardanoNetwork.MAINNET)) {</span>
<span class="nc" id="L177">            return &quot;314cdf9ea60ee354ff1b87da74f15dedd4070604b2819a1d6bac3453&quot;;</span>
        }
<span class="nc" id="L179">        return &quot;f2f25cfcc4e1665bad2477fc1aa6e9960ae59ef1681eae28a0bfed16&quot;;</span>
    }

    public static Optional&lt;Utxo&gt; getUtxoByTransactionAndUnit(String transactionHash, String unit, BackendService backendService) {
        Result&lt;TxContentUtxo&gt; transactionUtxos;
        try {
<span class="fc" id="L185">            transactionUtxos = backendService.getTransactionService().getTransactionUtxos(transactionHash);</span>
<span class="nc" id="L186">        } catch (ApiException e) {</span>
<span class="nc" id="L187">            log.error(&quot;Error getting transaction utxos: {}&quot;, e.getMessage());</span>
<span class="nc" id="L188">            return Optional.empty();</span>
<span class="fc" id="L189">        }</span>

<span class="pc bpc" id="L191" title="1 of 2 branches missed.">        if (transactionUtxos.isSuccessful()) {</span>
<span class="pc bpc" id="L192" title="1 of 2 branches missed.">            for (TxContentUtxoOutputs output : transactionUtxos.getValue().getOutputs()) {</span>
<span class="fc" id="L193">                Optional&lt;TxContentOutputAmount&gt; outputWithUnit = output.getAmount().stream().filter(amount -&gt; amount.getUnit().equals(unit)).findFirst();</span>
<span class="pc bpc" id="L194" title="1 of 2 branches missed.">                if (outputWithUnit.isPresent()) {</span>
<span class="fc" id="L195">                    return Optional.of(output.toUtxos(transactionHash));</span>
                }
<span class="nc" id="L197">            }</span>
        } else {
<span class="nc" id="L199">            log.error(&quot;Error getting transaction utxos: {}&quot;, transactionUtxos.getResponse());</span>
        }

<span class="nc" id="L202">        return Optional.empty();</span>
    }

    public static String extractStringFromPlutusData(PlutusData plutusData) {
<span class="fc" id="L206">        return new String(((BytesPlutusData) plutusData).getValue());</span>
    }

    public static String extractByteArrayFromPlutusData(PlutusData plutusData) {
<span class="fc" id="L210">        return HexUtil.encodeHexString(((BytesPlutusData) plutusData).getValue());</span>
    }

    public static List&lt;byte[]&gt; extractListFromPlutusData(PlutusData plutusData) {
<span class="fc" id="L214">        return ((ListPlutusData) plutusData).getPlutusDataList().stream()</span>
<span class="fc" id="L215">                .map(item -&gt; ((BytesPlutusData) item).getValue())</span>
<span class="fc" id="L216">                .collect(Collectors.toList());</span>
    }

    public static Integer extractIntegerFromPlutusData(PlutusData plutusData) {
<span class="fc" id="L220">        return ((BigIntPlutusData) plutusData).getValue().intValue();</span>
    }

    public static Boolean extractBooleanFromPlutusData(PlutusData plutusData) {
<span class="pc bpc" id="L224" title="1 of 2 branches missed.">        return ((ConstrPlutusData) plutusData).getAlternative() == 1;</span>
    }

    public static Long extractLongFromPlutusData(PlutusData plutusData) {
<span class="fc" id="L228">        return ((BigIntPlutusData) plutusData).getValue().longValue();</span>
    }

    public static boolean includesStateToken(TransactionOutput output) {
<span class="nc" id="L232">        return output.getValue().getMultiAssets().stream().anyMatch(</span>
<span class="nc bnc" id="L233" title="All 4 branches missed.">                asset -&gt; asset.getPolicyId() != null &amp;&amp; asset.getPolicyId().equalsIgnoreCase(getMintStateTokenHash(CardanoNetwork.MAINNET))</span>
<span class="nc bnc" id="L234" title="All 2 branches missed.">                        || asset.getPolicyId().equalsIgnoreCase(getMintStateTokenHash(CardanoNetwork.PREPROD))</span>
        );
    }

    public static boolean includesStateToken(AddressUtxo addressUtxo, CardanoNetwork network) {
<span class="fc" id="L239">        return addressUtxo.getAmounts().stream()</span>
<span class="fc bfc" id="L240" title="All 4 branches covered.">                .anyMatch(asset -&gt; asset.getPolicyId() != null &amp;&amp; asset.getPolicyId().equals(ValidatorUtils.getMintStateTokenHash(network)));</span>

    }

    public static boolean includesBootstrapToken(AddressUtxo addressUtxo, CardanoNetwork network) {
<span class="fc" id="L245">        return addressUtxo.getAmounts().stream()</span>
<span class="fc bfc" id="L246" title="All 4 branches covered.">                .anyMatch(asset -&gt; asset.getPolicyId() != null &amp;&amp; asset.getPolicyId().equals(ValidatorUtils.getMintOrBurnAuthTokenHash(network)));</span>
    }

    public static boolean isMintingTransaction(AddressUtxo addressUtxo, String policyId) {
<span class="fc" id="L250">        return addressUtxo.getAmounts().stream()</span>
<span class="pc bpc" id="L251" title="1 of 4 branches missed.">                .anyMatch(input -&gt; input.getPolicyId() != null &amp;&amp; input.getPolicyId().equals(policyId) &amp;&amp;</span>
<span class="pc bpc" id="L252" title="1 of 2 branches missed.">                        input.getQuantity().equals(BigInteger.ONE));</span>
    }

    public static boolean isBurningTransaction(AddressUtxo addressUtxo, String policyId) {
<span class="fc" id="L256">        return addressUtxo.getAmounts().stream()</span>
<span class="pc bpc" id="L257" title="1 of 4 branches missed.">                .anyMatch(input -&gt; input.getPolicyId() != null &amp;&amp; input.getPolicyId().equals(policyId) &amp;&amp;</span>
<span class="pc bpc" id="L258" title="1 of 2 branches missed.">                        input.getQuantity().equals(BigInteger.valueOf(-1)));</span>
    }

    public static String getBootstrapTokenName(AddressUtxo addressUtxo, CardanoNetwork network) {
<span class="nc" id="L262">        return addressUtxo.getAmounts().stream()</span>
<span class="nc bnc" id="L263" title="All 4 branches missed.">                .filter(input -&gt; input.getPolicyId() != null &amp;&amp; input.getPolicyId().equals(getMintOrBurnAuthTokenHash(network)))</span>
<span class="nc" id="L264">                .findFirst()</span>
<span class="nc" id="L265">                .map(Amt::getAssetName)</span>
<span class="nc" id="L266">                .orElseThrow(() -&gt; new IllegalArgumentException(&quot;Bootstrap token not found&quot;));</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.10.202304240956</span></div></body></html>