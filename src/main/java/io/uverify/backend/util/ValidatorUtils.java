/*
 * UVerify Backend
 * Copyright (C) 2025 Fabian Bormann
 *
 *  This program is free software: you can redistribute it and/or modify
 *  it under the terms of the GNU Affero General Public License as published by
 *  the Free Software Foundation, either version 3 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU Affero General Public License for more details.
 *
 *  You should have received a copy of the GNU Affero General Public License
 *  along with this program. If not, see <http://www.gnu.org/licenses/>.
 */

package io.uverify.backend.util;

import com.bloxbean.cardano.client.api.exception.ApiException;
import com.bloxbean.cardano.client.api.model.Result;
import com.bloxbean.cardano.client.api.model.Utxo;
import com.bloxbean.cardano.client.backend.api.BackendService;
import com.bloxbean.cardano.client.backend.model.TxContentOutputAmount;
import com.bloxbean.cardano.client.backend.model.TxContentUtxo;
import com.bloxbean.cardano.client.backend.model.TxContentUtxoOutputs;
import com.bloxbean.cardano.client.plutus.blueprint.PlutusBlueprintUtil;
import com.bloxbean.cardano.client.plutus.blueprint.model.PlutusVersion;
import com.bloxbean.cardano.client.plutus.spec.*;
import com.bloxbean.cardano.client.transaction.spec.TransactionOutput;
import com.bloxbean.cardano.client.util.HexUtil;
import com.bloxbean.cardano.yaci.store.common.domain.AddressUtxo;
import com.bloxbean.cardano.yaci.store.common.domain.Amt;
import io.uverify.backend.enums.CardanoNetwork;
import lombok.extern.slf4j.Slf4j;
import org.apache.commons.codec.binary.Hex;
import org.apache.commons.codec.digest.DigestUtils;
import scalus.bloxbean.ScalusScriptUtils;

import java.math.BigInteger;
import java.nio.charset.StandardCharsets;
import java.util.List;
import java.util.Optional;
import java.util.stream.Collectors;

@Slf4j
public class ValidatorUtils {
    public static String getProxyStateTokenName(String txHash, int outputIndex) {
        // Convert hex string to bytes
        byte[] txHashBytes;
        try {
            txHashBytes = Hex.decodeHex(txHash.toCharArray());
        } catch (java.lang.Exception exception) {
            log.error(exception.getMessage());
            return "";
        }
        // Convert outputIndex to string and then to bytes
        String outputIndexString = String.valueOf(outputIndex);
        byte[] outputIndexBytes = outputIndexString.getBytes(StandardCharsets.UTF_8);

        // Combine both byte arrays
        byte[] messageBuffer = new byte[txHashBytes.length + outputIndexBytes.length];
        System.arraycopy(txHashBytes, 0, messageBuffer, 0, txHashBytes.length);
        System.arraycopy(outputIndexBytes, 0, messageBuffer, txHashBytes.length, outputIndexBytes.length);

        // Calculate SHA3-256 hash and return as hex string
        return DigestUtils.sha3_256Hex(messageBuffer);
    }

    public static String validatorToScriptHash(PlutusScript script) {
        try {
            return HexUtil.encodeHexString(script.getScriptHash());
        } catch (Exception e) {
            log.error("Error computing policy id: " + e.getMessage());
            return null;
        }
    }

    public static PlutusScript getUVerifyStateContract() {
        String compiledCode = "5928750101002229800aba4aba2aba1aba0aab9faab9eaab9dab9cab9a9bae0039bae00248888888888a60022a660089212b657870656374206e6578745f73746174653a205374617465446174756d203d206e6578745f696e6c696e6500168a998022492f6578706563742063757272656e745f73746174653a205374617465446174756d203d20696e6c696e655f646174756d00168a998022493765787065637420426f6f747374726170446174756d207b20746f6b656e5f6e616d652c202e2e207d203d20696e6c696e655f646174756d00168a998022493765787065637420626f6f7473747261705f646174756d3a20426f6f747374726170446174756d203d20626f6f745f646174756d5f616e7900168a998022492865787065637420496e6c696e65446174756d28696e6c696e655f646174756d29203d20646174756d00168a998022493c65787065637420536f6d65287363726970745f6f757470757429203d206d617962655f7363726970745f6f75747075745f776974685f706f6c69637900168a998022493565787065637420626f6f7473747261705f646174756d3a20426f6f747374726170446174756d203d20696e6c696e655f646174756d00168a998022492d6578706563742073746174655f646174756d3a205374617465446174756d203d20696e6c696e655f646174756d00168a998022493b65787065637420496e6c696e65446174756d28696e6c696e655f646174756d29203d2073746174655f696e7075742e6f75747075742e646174756d00168a99802249ff65787065637420536f6d652873746174655f696e70757429203d0a2020202020202020202020202020202020206c6973742e66696e64280a2020202020202020202020202020202020202020696e707574732c0a2020202020202020202020202020202020202020666e28696e70757429207b0a2020202020202020202020202020202020202020202031203d3d207175616e746974795f6f66280a202020202020202020202020202020202020202020202020696e7075742e6f75747075742e76616c75652c0a20202020202020202020202020202020202020202020202070726f78795f706f6c6963795f69642c0a20202020202020202020202020205820202020202020202020746f6b656e5f6e616d652c0a20202020202020202020202020202020202020202020290a20202020202020202020202020202020202020207d2c0a2020202020202020202020202020202020202900168a998022491e72656465656d65723a2055566572696679537461746552656465656d657200164888888888896600330013011375402f370e90034dc3a4001370e9002244446465300130163754003301a006980d0012444b300130060038992cc00400a264b30013009301b375400713259800800c036264b30010018992cc00400601f13259800800c042021132598009812801c4c8cc8966002602200315980098121baa00780140510254566002600600315980098121baa00780140510254566002602000315980098121baa00780140510254566002602400315980098121baa0078014051025456600266e1d20080018acc004c090dd5003c00a028812a02881090212042408481084cc01c00889660020051980098121baa00c9ba548002460506052003223232330010010042259800800c00e2646644b30013372200e00515980099b8f0070028800c01902944cc014014c0c00110291bae3029001375660540026058002815052f5bded8c123028302930293029302930293029302930293029302900191814181498149814800c8c0a0c0a4c0a400646050605260526052605260526052003230283029302930293029001911919800800801912cc00400629422b30013003302b0018a518998010011816000a04a40a53700900148c0a0c0a4c0a4c0a4c0a4c0a4c0a4c0a400644646600200200644b30010018a508acc004cdc79bae302b0010038a518998010011816000a04a40a523371090001b8d00192cc0040062946294102648c0a0c0a4c0a4c0a4c0a4c0a4c0a4c0a4c0a4006444b300130143026375400713259800800c00a264b3001001801c00e007003899912cc00400600b13259800800c01a00d00680344cc89660020030088992cc004006013009804c4cc896600200300b8992cc00400601900c80644cc896600200300e8992cc00400601f00f899912cc00400602313259800800c04a025012899912cc00400602913259800800c05602b015899912cc00400602f13259800800c06203101880c44cc896600200301a8992cc00400603701b80dc4cc896600200301d8992cc00400603d01e80f407a26644b300100181044c966002003132598009824000c56600266e252004304700181144c966002609a00913302e0142259800801409a264b3001001813409a04d026899180198288021bae0014144609c00482620468250c09cc11c00504540890491baa001810c086043021413060920028238dd700098240012092304600141106eb4004c11400a0368230c10c0050411bae0013042002410c608000281f0dd6800981f8014055040181e800a076375a002607800501240f4607400281c0dd6000981c801403e01e81d0c0dc0050351bad0013036002806206e303400140c86eb4004c0cc00a01281a0c0c400502f1bae001303000240c4605c0028160dd70009816801205c302b00140a4604e6ea800e002812246050605260526052605260520029111111111111111114c004c0e804a6eb0c0e404a44646600200200644b30010018a6103d87a80008992cc004c0100062602c6607a00297ae0899801801981f8012070303d00140ed22323259800980c800c4c966002603460746ea8c054c0ecdd5180a981d9baa005899b88001004899b8900100440e06eb4c0f4c0e8dd50014566002604c00314a114a281b9037181c1baa001303b30383754602460706ea800a44b30010018a40011300a33002002303c00140e52233008002001912cc0040062900044c028cc008008c0f00050394888c8cc88cc008008004896600200300389919912cc004cdc8803801456600266e3c01c00a200300640f1133005005304300440f06eb8c0f0004dd6981e800981f800a07a3301300400314800122222222980098210044dd618208044cc01801c8cdd79821181f9baa3042303f37546032607e6ea8004cdd2a4004660826ea40ed2f5c130040049112cc0066002601e0054a14a281f22b300132330010010032259800800c528c56600264b30015980098099bae30473044375400314a315330424912e627974655f61727261795f6e6f745f656d7074792863657274696669636174652e6861736829203f2046616c73650014a0820a2b30015980098099bae301a3044375400314a3153304249130627974655f61727261795f6e6f745f656d7074792863657274696669636174652e69737375657229203f2046616c73650014a0820a2b300133009004375c603460886ea800629462a660849201396b65795f7369676e65642865787472615f7369676e61746f726965732c2063657274696669636174652e69737375657229203f2046616c73650014a0820a29410414528208230460018998010011823800c5282080411113371e0066e48ca6002003003a45004004444b30010028800c66002007304800299b8a0013232323371466e28cdc51bae304a00337306e64dd718250011bae304a001329800800cdd61825982600152201004004444b30010028800c66002007304e00299b8a00137306e64dd718268012006412c6094002609200260886ea8c11c009003208a8a5040f914a081f2600400522230209800801c00a00280212222222980098249824803cdd61824003d66002606460886ea8016294629410424896600260686eb4c078c11cdd5000c528c56600260686eb4c074c11cdd5000c528c566003300130343370c60326eb4c070c11cdd50009bad301e304737540034a14a282222946264660020026eb0c070c120dd5001112cc00400629462b3001323301d00525980099baf3025304b37540026e98c966002607200314bd6f7b63044c8c8cc0040052f5bded8c044b300100189982899bb04c01014000374c00697adef6c608994c004dd71827800cdd59828000cc1500092225980099b904890000389982a99bb04c01014000374c00e00b15980099b8f4890000389982a99bb04c01014000374c00e003133055337606ea400cdd300119803003000a0a0414030520014140646600200297adef6c602259800800c4cc140cdd8261014000375000697adef6c608994c004dd71827000cdd69827800cc14c0092225980099b904890000389982a19bb04c01014000375000e00b15980099b8f4890000389982a19bb04c01014000375000e003133054337606ea400cdd400119803003000a09e413c3051001413c8248cdc19bad3021304b375400a60146eb0c07cc12cdd5002c4cdd7982718259baa304e304b3754002604c6609a6ea40092f5c114a08240dd71826000c4cc008008c13400629410462094411082210442444466453001304e0029bac304e304f002cc0056600200314a314a082629429450482444b300159800acc005660033001001a50a51412d14a3159800800c6600246054660a266e95200233051375200297ae0330514c103d87a80004bd704c134dd5182898271baa03592cc004006298103d87a800089815198289829000a5eb8105048966002003148002260446600400460a80028289222233225980099b87480200162b3001304130533754005132598009820982a1baa0018992cc0040062b300130433055375400313259800800c13e264b3001001828414226644b300100182944c966002003053829c14e0a71332259800800c156264b300100182b415a0ad1332259800800c162264b300100182cc1660b31332259800800c16e264b300100182e417226644b300100182f44c96600200305f82fc17e26644b3001001830c4c966002003062831418a26644b300100183244c966002003065832c196264b3001307200389982980b112cc00400a2660aa01844b30010028992cc004c180c1c8dd5000c566002b3001305230200298a518a99838a48119746f6b656e5f616d6f756e74203d3d2031203f2046616c73650014a083822b30015980099b8f018375c60ec60e66ea800629462a660e292122746f6b656e5f6e616d65203d3d206d696e7465645f746f6b656e203f2046616c73650014a083822b30013303802748811c11bcb8e4a79304e23bcd5e2bf628907f9b998f43902f41d1db439981008a518a99838a49306b65795f7369676e65642865787472615f7369676e61746f726965732c2061646d696e5f6b657929203f2046616c73650014a083822941070452820e08a99838a4815665787065637420536f6d65286d696e7465645f746f6b656e29203d0a2020202020202020202020202020202020206d696e7465645f746f6b656e73207c3e2070616972732e6b657973207c3e206c6973742e68656164001641c06044646600200205244b30010018a5eb822660ec60e660ee0026600400460f000283aa264b3001001835c1ae0d706b8991801983c0021bae00141e060ea004839a264b3001001834c1a60d30698991801983b0021bae00141d860e6004838a0cc8378dd6800c1950721837800a0da375a00260dc00506241bc60d80028350dd68009835801417d06c1834800a0ce375800260d000505c82e20d2306600141906eb4004c19400a0b28330c18c0050611bad001306200282b20c6306000141786eb8004c17c009060182e800a0b6375800260b800505082820ba305a001416060ac6ea800609c829a09d04e827413905b182c182a9baa001825a0a43057305830583054375460ae60a86ea800a092828a26644b300130440078acc004c10cc154dd500244c966002608660ac6ea8006264b30010018cc004006264b3001304630583754003132598009823182c9baa0018992cc00400633001001899192cc004c128c170dd5000c4cc8966002b30013370e601802a66e0000400a29462a660ba9201446c6973742e6c656e677468286d696e7465645f746f6b656e7329203d3d20746f6b656e735f6275726e6564202b20746f6b656e735f63726561746564203f2046616c73650014a082e22b3001303e0028acc004cdc4800a400515980099b8f375c60c460be6ea800cdd71831182f9baa0088acc00566002646606605246466e3cdc919b8a375c60ca00330014a1480126eb4c194c1980057920033061375460c860c26ea8004dd71831182f9baa0088a518a9982ea4812d6861735f756e697175655f69642873746174655f646174756d2e69642c20696e7075747329203f2046616c73650014a082e22b30015980099b89301c3758607260be6ea8118dd69816182f9baa0088a518a9982ea481446c6973742e6c656e6774682872656465656d65722e63657274696669636174657329203c3d2073746174655f646174756d2e62617463685f73697a65203f2046616c73650014a082e22b300159800cc004dd71818182f9baa0089bac3039305f375408d013407514a3153305d4916b6365727469666963617465735f6172655f76616c69642873746174655f646174756d2e63657274696669636174655f646174615f686173682c2072656465656d65722e6365727469666963617465732c2065787472615f7369676e61746f7269657329203f2046616c73650014a082e22b300159800acc005660026eb0c188c17cdd5002c528c52820c08a518a9982ea493a6c6973742e69735f656d70747928626f6f7473747261705f646174756d2e616c6c6f7765645f63726564656e7469616c7329203f2046616c73650014a082e229462b30013302f375860c460be6ea8014dd7181c982f9baa0088a518a9982ea49486c6973742e68617328626f6f7473747261705f646174756d2e616c6c6f7765645f63726564656e7469616c732c2073746174655f646174756d2e6f776e657229203f2046616c73650014a082e105c4566002b30015980099b8f375c607260be6ea8020dd7181c982f9baa008899baf323232303d33064306500333064306500233064303830623754010660c8607260c46ea8020cc190c0d8c188dd500419832181698311baa00833064375066e00dd6981b98311baa00848004cc190c194004cc190c0ccc188dd500419832181e18311baa0083066306630660013065306530653065306530650013064001305f375401001114a082e229462a660ba9214d73746174655f646174756d5f69735f76616c69642873746174655f646174756d2c2073746174655f646174756d2e6f776e65722c20626f6f7473747261705f646174756d29203f2046616c73650014a082e22b3001598009980b80c8044528c54cc175240132636f6e7461696e735f736572766963655f666565286f7574707574732c2073746174655f646174756d29203f2046616c73650014a082e22b300159800998131818182f9baa047375a605460be6ea802229462a660ba9213d746f6b656e5f6e6f745f657870697265642874782e76616c69646974795f72616e67652c2073746174655f646174756d2e74746c29203f2046616c73650014a082e22b300133024013375c607260be6ea802229462a660ba9201386b65795f7369676e65642865787472615f7369676e61746f726965732c2073746174655f646174756d2e6f776e657229203f2046616c73650014a082e2294105c452820b88a50417114a082e2294105c452820b88a50417114a082e2294105c452820b88a50417060380046038660120269000c54cc16d24013165787065637420536f6d652861737365745f6e616d6529203d206c6973742e6865616428756e697175655f6d696e7473290016416860180026600e02290014149006414a0a505282920c0305d305a375400315330584913f65787065637420496e6c696e65446174756d28626f6f745f646174756d5f616e7929203d20626f6f7473747261705f7265662e6f75747075742e646174756d0016415c605e60b26ea8c0ccc164dd5182e182c9baa0018a9982ba49ff65787065637420536f6d6528626f6f7473747261705f72656629203d0a2020202020202020202020202020202020206c6973742e66696e64280a20202020202020202020202020202020202020207265666572656e63655f696e707574732c0a2020202020202020202020202020202020202020666e287265665f696e29207b0a20202020202020202020202020202020202020202020616e64207b0a2020202020202020202020202020202020202020202020207265665f696e2e6f75747075742e61646472657373203d3d2066726f6d5f7363726970742870726f78795f706f6c6963795f6964292c0a20202020202020202020202020202020202020ff20202020206861735f6e6674280a20202020202020202020202020202020202020202020202020207265665f696e2e6f75747075742e76616c75652c0a202020202020202020202020202020202020202020202020202070726f78795f706f6c6963795f69642c0a202020202020202020202020202020202020202020202020202073746174655f646174756d2e626f6f7473747261705f646174756d5f6e616d652c0a202020202020202020202020202020202020202020202020292c0a202020202020202020202020202020202020202020207d0a20202020202020202020202020202020202020207d2c0a202020202020202020202020202020202002202900164158660400324b30013375e60b860b26ea8c0ccc164dd5000980582ac660026eacc0ccc164dd51819982c9baa00182acdd7182e182e982e982e982e982e982e982e982e982e982c9baa002405514a082b2096812209704b825c12d05d182d182b9baa001826a0a83059305a305a3056375460b260ac6ea8012096829a264b300130440088992cc004c114c15cdd5000c4c8c966002608e60b26ea8006264b30013047305a375400313259800800c66002003159800acc004cdc79bae3036305c375400200914a3153305a49130626f6f7473747261705f646174756d2e746f6b656e5f6e616d65203d3d20746f6b656e5f6e616d65203f2046616c73650014a082ca2b30015980098030054528c54cc16924013069735f6e6f6e65286d617962655f7363726970745f6f75747075745f776974685f706f6c69637929203f2046616c73650014a082ca2b30013302101048811c11bcb8e4a79304e23bcd5e2bf628907f9b998f43902f41d1db439981008a518a9982d249306b65795f7369676e65642865787472615f7369676e61746f726965732c2061646d696e5f6b657929203f2046616c73650014a082ca2941059452820b2828200e82841420a1050418460bc60b66ea800609a82c0c0c0c168dd5181a182d1baa305d305a375400304b415c660420444607330013756606860b46ea8c0d0c168dd5000c15a00480e8dd7182d982c1baa0018a9982b2493265787065637420536f6d6528746f6b656e5f6e616d6529203d206c6973742e6865616428746f6b656e735f6275726e65642900164154600e6600601a9000c566002606c0111323322598009823982c9baa001899192cc004c124c16cdd5000c4c966002609260b86ea8006264b30010018cc0040062b30015980099b87300b0140068a518a9982e249336c6973742e6c656e677468286d696e7465645f746f6b656e7329203d3d20746f6b656e735f6275726e6564203f2046616c73650014a082da2b300159800998118091bae3038305e375400314a3153305c491386b65795f7369676e65642865787472615f7369676e61746f726965732c2073746174655f646174756d2e6f776e657229203f2046616c73650014a082da2b30015980099b8f004375c60c260bc6ea800629462a660b892124746f6b656e5f6e616d65203d3d2073746174655f646174756d2e6964203f2046616c73650014a082da2b300159800cc004c0f4c174dd5181b182f1baa001a50a51416d14a3153305c491232173746174655f646174756d2e6b6565705f61735f6f7261636c65203f2046616c73650014a082da2b30015980098161bac3038305e375408b14a3153305c4912c6c6973742e69735f656d7074792872656465656d65722e63657274696669636174657329203f2046616c73650014a082da2b300159800981e8034528c54cc17124011a746f6b656e735f6275726e6564203d3d2031203f2046616c73650014a082da2b3001300800c8a518a9982e24813069735f6e6f6e65286d617962655f7363726970745f6f75747075745f776974685f706f6c69637929203f2046616c73650014a082da294105b452820b68a50416d14a082da294105b452820b6828a054828c1460a3051418c60c060ba6ea800609e82d0c0c8c170dd5181b182e1baa305f305c375400304d4164660460484607730013756606c60b86ea8c0d8c170dd5000c16200480f8dd7182e982d1baa0018a9982c24813965787065637420536f6d6528746f6b656e5f6e616d6529203d206c6973742e6865616428756e697175655f6275726e65645f746f6b656e73290016415c602e00260100026600601a9000c52820a841504b300130443056375400314a114a282a1053111919800800801912cc004006297ae08994c004dd7182c000cdd6982c800cc1740092225980099b8700700289982f1ba900333006006001899803003000a0b2182d800a0b2222598009822182b1baa0038992cc00400600513259800800c00e0071332259800800c016264b3001001803401a00d006899912cc00400601113259800800c026013009899912cc00400601713259800800c03201900c899912cc00400601d13259800800c03e01f1332259800800c046264b3001001809404a0251332259800800c052264b300100180ac05602b1332259800800c05e264b300100180c4062031132598009839801c4cc150058896600200513305600c2259800801407a264b300100180f407a03d01e8991801983c8021bae00141e460ec00483a2264b300100180e407203901c8991801983b8021bae00141dc60e800483920328380dd6800c0610731838000a0dc375a00260de00501541c060da0028358dd68009836001404906d1835000a0d0375800260d200500f807a0d4306700141946eb4004c19800a0188338c1900050621bad0013063002804a0c83061001417c6eb8004c180009061182f000a0b8375800260ba005003801a0bc305b001416460ae6ea800e00282a10511980d00612cc004cdd7982b18299baa001300504f8acc004c8cc004004cc0b4dd59817182a1baa0020502259800800c52844c8c9660026600800860b600714a313036375a60ae00482a0dd7182a800982c000a0ac8cc00660026eacc0b4c14cdd5000c13e09c807a942945050452820a08a50414060020028a50412c825a29462a6609892011a706173735f6d696e74696e675f6c6f676963203f2046616c73650014a0825a2b300159800cc00401e94294504b4528c56600200f159800981d98269baa00e899192cc004c0f0c13cdd5000c4cc8966002607e00310058acc004c0c4006200b159800981f000c5660020051980080144c966002606460a46ea80062646464b300130433055375400313232598009822182b9baa0018992cc004006330010018acc004cc078034dd71819982c9baa0098acc004cdd7982e182c9baa003305c30593754606660b26ea802e2b3001303830160058acc00660026eacc0ccc164dd5001c01a6eb8c170c164dd5004a02a8acc00566002b30013371090001bad302e3059375401313302000e375a604860b26ea802629410564528c54cc15d2413569735f73746174655f616c6976652863757272656e745f73746174652c2076616c69646974795f72616e676529203f2046616c73650014a082b22b300159800acc0066002607060b06ea8c0c4c164dd5004d28528a0ac899baf323232323232303a33061306200633061306200533061306200433061306200333061306200233061306200133061375066e00dd6981a182f9baa00f48004c18cc18c004c188004c184004c180004c17c004c178004c164dd5004800c52820ac8a518a9982ba481387665726966795f73746174655f6d75746174696f6e286e6578745f73746174652c2063757272656e745f737461746529203f2046616c73650014a082b22b30015980099808809800c528c54cc15d240131636f6e7461696e735f736572766963655f666565286f7574707574732c206e6578745f737461746529203f2046616c73650014a082b22b30015980099b8930163758606660b26ea8100dd69813182c9baa0018a518a9982ba481436c6973742e6c656e6774682872656465656d65722e63657274696669636174657329203c3d206e6578745f73746174652e62617463685f73697a65203f2046616c73650014a082b22b300198009bae302a305937540033758606660b26ea810201a80ba29462a660ae92016a6365727469666963617465735f6172655f76616c6964286e6578745f73746174652e63657274696669636174655f646174615f686173682c2072656465656d65722e6365727469666963617465732c2065787472615f7369676e61746f7269657329203f2046616c73650014a082b22941056452820ac8a50415914a082b22941056452820ac8a50415914a082b20a6812a0a7053829c14d05e182d982c1baa0018a9982b2493565787065637420496e6c696e65446174756d286e6578745f696e6c696e6529203d207363726970745f6f75747075742e646174756d00164154605a60ae6ea8004c164c158dd5000c54cc1512413665787065637420536f6d65287363726970745f6f757470757429203d206c6973742e68656164287363726970745f6f757470757473290016414cb30010018a6103d87a8000898181982b982c000a5eb810561919800800807912cc004006297ae0899912cc004c966002607060b06ea8006266e3c018dd7182e182c9baa0018a50415860b660b06ea8c16cc160dd500144cc168008cc01001000626600800800282a8c164004c1680050571bae305630533754003153305149015a657870656374205363726970742870726f78795f706f6c6963795f696429203d0a202020202020202020202020202020202020696e7075742e6f75747075742e616464726573732e7061796d656e745f63726564656e7469616c0016414060aa60a46ea8c154c148dd5181618291baa004825a03c825c12e09704b415d14a0827904f209e305330503754002609e6ea8c14cc140dd501bc54cc13924013565787065637420496e6c696e65446174756d28696e6c696e655f646174756d29203d20696e7075742e6f75747075742e646174756d00164134604a609e6ea8c0a4c13cdd5000982898271baa00e8a9982624812a65787065637420536f6d6528696e70757429203d206f7074696f6e616c5f73746174655f7570646174650016412d14a0825904b4528c54cc1312411b706173735f7370656e64696e675f6c6f676963203f2046616c73650014a0825a294104b4528c54cc1312413e616e64207b0a2020706173735f6d696e74696e675f6c6f6769633f2c0a2020706173735f7370656e64696e675f6c6f6769633f2c0a7d203f2046616c73650014a08258609a609a609a008660446eacc1300101142264b30010018acc004c048c090dd5000c4c9660020030168992cc00400602f01780bc05e26644b300100180cc4c96600200301a80d406a0351332259800800c072264b300100180ec07603b01d899912cc00400603f13259800800c08204113259800981a801c4cc05800489660020051301030370118992cc0040060490248124092264600660720086e64dd7000a072303600240d102140c86eb000604102040d460640028180dd700098188012064302f00140b46e64dd70009817001205e302c00140a86eb8004c0ac00902c1814800a04e30253754003015408901580ac05602a8150c09c00902518109baa005370e900140450221bac00180840410251811000a0403022002807403a01d00e408c604000280f0c070dd5001c03101911191980080080191198018009801001402e01700b805a040301d301a37540091598009804001c4c8c966002601260366ea8c07cc08000a29462c80c8dd6980f000980d1baa0048b202e405c3019301a001301900445268a99807a4811856616c696461746f722072657475726e65642066616c7365001365640381";
        return PlutusBlueprintUtil.getPlutusScriptFromCompiledCode(compiledCode, PlutusVersion.v3);
    }

    public static PlutusScript getLibraryContract() {
        String compiledCode = "589f010100229800aba2aba1aab9faab9eaab9dab9a9bae002488888896600264646644b30013370e900118039baa0018994c004c02c006601660180032259800800c528456600266e3cdd718068008044528c4cc008008c03800500920184888cc004004dd618071807980798079807980798079807980798061baa300e00818041baa0018b200c300800130083009001300800130043754011149a26cac80101";
        return PlutusBlueprintUtil.getPlutusScriptFromCompiledCode(compiledCode, PlutusVersion.v3);
    }

    public static PlutusScript getLibraryContract(String paymentCredential) {
        PlutusScript plainScript = getLibraryContract();

        String parameterizedScript = ScalusScriptUtils.applyParamsToScript(plainScript.getCborHex(),
                BytesPlutusData.of(paymentCredential));
        return PlutusV3Script.builder().cborHex(parameterizedScript).build();
    }

    public static PlutusScript getUVerifyStateContract(String scriptHash, String proxyTokenName) {
        PlutusScript plainScript = getUVerifyStateContract();

        String parameterizedScript = ScalusScriptUtils.applyParamsToScript(plainScript.getCborHex(),
                BytesPlutusData.of(HexUtil.decodeHexString(scriptHash)),
                BytesPlutusData.of(HexUtil.decodeHexString(proxyTokenName)));
        return PlutusV3Script.builder().cborHex(parameterizedScript).build();
    }

    public static PlutusScript getUVerifyStateContract(String txHash, int outputIndex) {
        PlutusScript proxyContract = getUverifyProxyContract(txHash, outputIndex);
        String proxyScriptHash = validatorToScriptHash(proxyContract);

        if (proxyScriptHash == null) {
            throw new IllegalArgumentException("Script hash of proxy contract is null");
        }

        String proxyTokenName = getProxyStateTokenName(txHash, outputIndex);

        PlutusScript plainScript = getUVerifyStateContract();

        String parameterizedScript = ScalusScriptUtils.applyParamsToScript(plainScript.getCborHex(),
                BytesPlutusData.of(HexUtil.decodeHexString(proxyScriptHash)),
                BytesPlutusData.of(HexUtil.decodeHexString(proxyTokenName)));
        return PlutusV3Script.builder().cborHex(parameterizedScript).build();
    }

    public static PlutusScript getUVerifyProxyContract() {
        String compiledCode = "59142f010100229800aba4aba2aba1aba0aab9faab9eaab9dab9cab9a488888888a60022a6600492012e6578706563742050726f7879446174756d207b207363726970745f6f776e65722c202e2e207d203d20646174756d00168a998012491b72656465656d65723a2050726f78794d696e7452656465656d657200168a99801249806578706563742050726f7879446174756d207b0a202020202020202020207363726970745f706f696e7465723a205f7363726970745f706f696e7465722c0a202020202020202020207363726970745f6f776e65723a206f6c645f7363726970745f6f776e65722c0a20202020202020207d203d20696e7075745f646174756d00168a99801249816578706563742050726f7879446174756d207b0a202020202020202020207363726970745f706f696e7465723a205f7363726970745f706f696e7465722c0a202020202020202020207363726970745f6f776e65723a206e65775f7363726970745f6f776e65722c0a20202020202020207d203d206f75747075745f646174756d00168a99801249266578706563742070726f78795f646174756d3a2050726f7879446174756d203d20646174756d00168a998012493b65787065637420496e6c696e65446174756d28646174756d29203d207363726970745f706f696e7465725f7265662e6f75747075742e646174756d00168a998012494065787065637420536f6d65287363726970745f706f696e7465725f72656629203d206c6973742e68656164287363726970745f706f696e7465725f726566732900168a998012491c72656465656d65723a2050726f78795370656e6452656465656d65720016488888889660033001300c37540252232330010010032259800800c528456600266e3cdd71809800801c528c4cc008008c05000500d2022911919800800801912cc00400629422b30013375e602600200714a313300200230140014034808a44b30010018a5eb82266020601a6022002660040046024002807a6e1d20009180818089808800cdd2a4001374a9001488c8cc00400400c896600200314bd7044cc8966002600a00513301400233004004001899802002000a01e3013001301400140452259800800c52f5c1133010300d3011001330020023012001403d2301030110019112cc004cdc48012400110018cc00400e66e10009201499b8b3370066e14009201448180005003201891111919800800802912cc004006200b13259800800c4cc010c05800801a26600a602c0046600600600280a0c058005013488c8c8cc004004010896600200300389919912cc004cdc8803801456600266e3c01c00a20030064045133005005301800440446eb8c044004dd59809000980a000a02414bd6f7b6304dc3a4005370e90022444444444444444530013020010980f808488cc044008006601a01b222598009807980f1baa0038992cc00400600513259800800c00e007003801c4cc89660020030058992cc00400600d006803401a264b30013029003804401d0261bae00140a4604c0028120dd70009812801204c30230014084603e6ea800e00280e24b30010018a60103d87a8000898059980f9810000a5eb8101e48c02ccc07cc028cc07cdd4800a5eb80cc07d30103d87a80004bd704c01c01e600a00a911111111199119194c0048dcc998011ba80014881009816006cc0a0dd50022444b3001301c0018992cc00400e26644b3001301f0018acc004c0bcdd5002c00a05481822b300130150018acc004c0bcdd5002c00a0548182054816102c099191919194c004dd5981a800cdd6181a981b181b000cdc999b8a375c606a60646ea80e4dcc18049bad301c303237540733756606a00491112cc004c070c0d4dd500644c966002660026eb0c0e80288cdd7981d981c1baa00103f899192cc004c0a4c0e0dd5000c4c966002603e60726ea8006264b30010018acc004c0acc0e8dd5000c4c9660020030388992cc00400607303981cc0e626644b300100181dc4c96600200303c81e40f2079132598009822801c566002b30013027323300100100b2259800800c52000899b8048008cc008008c11c0050444528c54cc0fd241286c6973742e6c656e677468287363726970745f6f75747075747329203d3d2031203f2046616c73650014a081f22b3001332259800801452844ca600264b30013035304437540031375a608a60906eacc120c114dd5000c520004108608e003375e608e609000337560069112cc0040062b30013002006899802801a400114a08222264b30013375e608e0029810140008acc004cc018010dd6982418259bab3048001898019ba6304c0028a5041151598009980300224001130030078a5041148228c1280050480ca600200300f9119824001198241ba60014bd7020022225980080144cc005300103d87a80004bd6f7b63044ca60026eb8c1180066eacc11c00660960069112cc004cdc8a441000038acc004cdc7a44100003899802981c198261ba60024bd70000c4cc015300103d87a8000006411d19800803c006446600e0046609c66ec0dd48029ba6004001401c82386092004823a2942294229410481ba633043337606ea4054dd31982199bb0375201a98010101004bd6f7b63025eb7bdb1808928c56600266016014460506466446600400400244b3001001801c4c8cc896600266e4405000a2b30013371e0280051001803208a8998028029826002208a375c608a0026eb4c118004c120005046198151bab302d3043375400402e2900045660026604601c00314a3153303f4901336b65795f7369676e65642865787472615f7369676e61746f726965732c207363726970745f6f776e657229203f2046616c73650014a081f2294103e4528207c8a5040f903d41086eb80050451821000a080375c00260820048210c0fc00503d181d9baa00181ba07081bc0de06f0374100607a60746ea80062a6607092012165787065637420496e6c696e65446174756d28646174756d29203d20646174756d001640dc6078607a607a60726ea8c0f0c0e4dd5000c54cc0dd24012f65787065637420536f6d65286f757470757429203d206c6973742e68656164287363726970745f6f75747075747329001640d8602e002660466eb0c0e80208c966002603e60706ea8006266e3c034dd7181e181c9baa0018a5040d8607660706ea8c0ecc0e0dd5000c54cc0d5241536578706563740a202020202020202020206c6973742e616e7928696e707574732c20666e28696e70757429207b20696e7075742e6f75747075745f7265666572656e6365203d3d207574786f5f726566207d29001640d044646600200200644b30010018a508acc004c00cc0f40062946266004004607c00281b903b44cc89660026050606e6ea8006264b3001301e3038375400313259800800c66002003159800acc00660026605a00800d4a14a281ba29462a6607092132216c6973742e686173286d696e7465645f746f6b656e732c2073746174655f746f6b656e5f6e616d6529203f2046616c73650014a081ba2b30013302c301b00830273303c303d303a375400297ae08a518a9981c2481516c6973742e68617328696e636c756465645f7769746864726177616c5f736372697074732c205363726970742870726f78795f646174756d2e7363726970745f706f696e7465722929203f2046616c73650014a081ba294103740c901a40ca065032819207e303c3039375400303040d8604e60706ea8c088c0e0dd5181d981c1baa001817206a30133301d00100a301533022375860720104b30013302a30143301e37566042606e6ea8c084c0dcdd5000805801c4cdd7981d181b9baa302130373754002602a01714a081a10330c0d4c0d4004c0d0c0d0004c0cc004c0c8004c0b4dd500818161baa00381440a205102840c86eb8c0bcc0b0dd5003c5660026024003132332259800802c4cc8966002604200315980098189baa00780140990324566002602e00315980098189baa0078014099032409902e205c1332232323298009bab30370019bac303730383038001998021bac303700523375e6070606a6ea8004021222598009813981b1baa001899192cc004c07cc0e0dd5000c660026eb8c0f0c0e4dd5000cc0f4c0e4dd51811981c9baa0029b93337146eb8c0f0c0e4dd50201b983010375a604660726ea81012223322598009812181e9baa0148992cc004c0bcc0f8dd5000c4c966002604a607e6ea8006264b30010018acc004c0c4c100dd5000c4c96600200303b8992cc00400607903c81e40f226644b300100181f44c96600200303f81fc0fe07f132598009825801c5660026058608c6ea802e264b30010018acc004c0e0c11cdd5000c4c9660020030438992cc004006089044822411226644b300100182344c966002003047823c11e08f132598009829001c5660033001011a50a51412d1598009981800c800c56600266e3c0200062946266060032010825a294104b45282096824209e375c0028290c13c00504d1bae001304e002413c60980028250c120dd5000c109045410a085042821209a304a30473754017153304549012d65787065637420496e6c696e65446174756d28696e7075745f646174756d29203d20696e7075745f646174756d0016411104041206eb800504b1824000a08c375c002608e0048240c11400504318209baa00181d207c81d40ea07503a4118608660806ea80062a6607c9212f65787065637420496e6c696e65446174756d286f75747075745f646174756d29203d206f75747075745f646174756d001640f4608460866086607e6ea8c108c0fcdd5000c54cc0f52401ff65787065637420536f6d65287363726970745f6f757470757429203d0a202020202020202020206c6973742e66696e64280a2020202020202020202020206f7574707574732c0a202020202020202020202020666e286f757470757429207b0a20202020202020202020202020206c6574207265665f746f6b656e73203d0a202020202020202020202020202020206f75747075742e76616c75650a2020202020202020202020202020202020207c3e20746f6b656e7328706f6c6963795f6964290a2020202020202020202020202020202020207c3e20646963742e746f5f706169727328290a2020202020202020202020202020202020207c3e207061ef6972732e6b6579730a0a20202020202020202020202020206c6574206861735f73746174655f746f6b656e203d206c6973742e686173287265665f746f6b656e732c2073746174655f746f6b656e5f6e616d65290a0a2020202020202020202020202020616e64207b0a202020202020202020202020202020206861735f73746174655f746f6b656e2c0a202020202020202020202020202020206f75747075742e61646472657373203d3d2066726f6d5f73637269707428706f6c6963795f6964292c0a20202020202020202020202020207d0a2020202020202020202020207d2c0a2020202020202020202029001640f06601c6eb0c1040309660026606460386604c6eacc0a4c0fcdd500080300244cdd79821181f9baa001301d0068a5040f1132598009817981f1baa0018992cc004c094c0fcdd5000c4c96600200319800800c566002009133033302200d302e3304330443041375400297ae08a5040f9039408503981cc0e60728230c10cc100dd5000c0dd03d1817181f9baa3029303f37546084607e6ea800606a81e0c074cc0a8dd6182080692cc004cc0c8c070cc098dd59814981f9baa3029303f375400200c00913375e6084607e6ea8c0a4c0fcdd5000980e8034528207840ec607e608000530013302f3019330233756607e0040060034a14a281c91533037491486578706563742053637269707428706f6c6963795f696429203d207370656e745f696e7075742e6f75747075742e616464726573732e7061796d656e745f63726564656e7469616c001640d8607660706ea8c0ecc0e0dd51811181c1baa001303a30373754003153303549013f65787065637420536f6d65287370656e745f696e70757429203d2066696e645f696e70757428696e707574732c207370656e745f6f75747075745f72656629001640d0303730373037303700130360013035002302f375402444646600200200644b30010018a60103d87a80008992cc004c010006260446606c00297ae0899801801981c0012062303600140d0605c6ea8016049024812409103418180009818181880098161baa0078b205240a430010012223259800801c4c8c8cc88cc024008cdc524501280059800800c4cdc52441035b5d2900006899b8a489035b5f20009800800ccdc52441025d2900006914c00402a00530070014029229800805400a002805101720605980099b880014803a266e0120f2010018acc004cdc4000a41000513370066e01208014001480362c815102a1bac302d002375a60560026466ec0dd418158009ba7302c001375400713259800800c4cdc52441027b7d00003899b8a489037b5f20003232330010010032259800800c400e264b30010018994c00402a6060003337149101023a200098008054c0c400600a805100a181980144ca6002015303000199b8a489023a200098008054c0c4006600e66008008004805100a18198012062303300140c066e29220102207d0000340b46eac00e264b3001001899b8a489025b5d00003899b8a489035b5f20009800800ccdc52441015d00003914c00401e0053004001401d229800803c00a0028039014205a3758007133005375a0060051323371491102682700329800800ccdc01b8d0024800666e292210127000044004444b3001337100049000440062646645300100699b800054800666e2ccdc00012cc004cdc40012402914818229037205e3371666e000056600266e2000520148a40c11481b902f002200c33706002901019b8600148080cdc70020012058375c0068180dc5245022c2000302830290092232330010010032259800980c800c4cdc524410130000038acc004cdc4000a40011337149101012d0033002002337029000000c4cc014cdc2000a402866e2ccdc019b85001480512060003409881308a4d153300a4911856616c696461746f722072657475726e65642066616c7365001365640241";
        return PlutusBlueprintUtil.getPlutusScriptFromCompiledCode(compiledCode, PlutusVersion.v3);
    }

    public static PlutusScript getUverifyProxyContract(Utxo utxo) {
        return getUverifyProxyContract(utxo.getTxHash(), utxo.getOutputIndex());
    }

    public static PlutusScript getUverifyProxyContract(String txHash, int outputIndex) {
        PlutusScript plainScript = getUVerifyProxyContract();

        PlutusData outputReference = ConstrPlutusData.of(0,
                BytesPlutusData.of(HexUtil.decodeHexString(txHash)),
                BigIntPlutusData.of(outputIndex));


        String parameterizedScript = ScalusScriptUtils.applyParamsToScript(plainScript.getCborHex(), outputReference);
        return PlutusV3Script.builder().cborHex(parameterizedScript).build();
    }

    public static String getMintOrBurnAuthTokenHash(CardanoNetwork network) {
        if (network.equals(CardanoNetwork.MAINNET)) {
            return "a8172157733dd50ef6f0f8d38e361745037f0a79c1f5da9b1d8079ff";
        }
        return "d3c25617941168e238038f1cf6542229b919bbd6fd2b8292ce176203";
    }

    public static String getMintStateTokenCode(CardanoNetwork network) {
        if (network.equals(CardanoNetwork.MAINNET)) {
            return "590b9301010032323232323232253330023232323232533233008300130093754004264646464646464a666024602a004264646464646464646464a666032601a012264646464646464646464646464646464646464646464a66605e60466030002264a666060605260626ea80044c94ccc0c4c094c0740184c94ccc0c8c0acc0ccdd500089919299981a19b8748010c0d4dd5000899299981a9817181b1baa00113232323232323232323232323232323232323232533304c304f00213302b01322533304e00213302d0092253330500021533304d304133302837566064609e6ea8c0c8c13cdd500da451ca8172157733dd50ef6f0f8d38e361745037f0a79c1f5da9b1d8079ff00375c606a609e6ea806454ccc134cdd7981898279baa3031304f37546064609e6ea806ccdd2a4004660a298011e581ca8172157733dd50ef6f0f8d38e361745037f0a79c1f5da9b1d8079ff004bd70099299982729998271823981b8008a5113303400101e132533304f3043303b001132533305030493051375400226464a6660a466e1d200430533754002264a6660a6609860a86ea80044c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c94ccc1b8c1c40084cc13402c894ccc1c00084cc13c01c894ccc1c800854ccc1bccdc781f9bae30543071375403a2a6660de60c66660946eacc150c1c4dd500f83381f8a99983799baf30533071375460a660e26ea807ccdd2a4004660e6609260e26ea80752f5c02a6660de664464a6660e460cc60e66ea80044c94ccc1ccc19cc1d0dd5182c183a9baa305830753754008266e2000400c4cdc48008019bad3077307437540022940c154c1ccdd5182b18399baa0023048307137540d86eb4c120c1c4dd500e8a999837a99983799b8f375c60a860e26ea80740fc54ccc1bccdc79bae30573071375403a6eb8c150c1c4dd501d8a99983799b8f375c609260e26ea8074dd7182498389baa03b1533306f3370e6eb4c190c1c4dd500e9bad3064307137540762a6660de66e1cdd6982698389baa01d375a609a60e26ea80ec54ccc1bccdd7982718389baa01d304e307137540762a6660de66e1cdd6982418389baa01d375a609060e26ea80ec54ccc1bccdc39bad304f3071375403a6eb4c140c1c4dd501d8a99983799b8f375c60e860ea60ea60ea60ea60ea60ea60ea60ea60ea60ea60ea60e26ea8074dd7182b98389baa03b13370e6eb4c158c1c4dd500e99b80375a60ac60e26ea80ed200114a029405280a5014a029405280a5014a02a6660de66e24c16cdd6182818389baa01d375a609e60e26ea807454ccc1bcc8cc004004dd6182898391baa01e22533307400114a2264a6660e464a6660e660ac6eb8c15cc1d4dd50008a999839982b1bae305b307537540022660b26eb0c168c1d4dd50381bae305b307537540022940528183b8010998018018008a5030770011533306f533306f3068375a609a60e26ea80745288a99983798341bad30643071375403a294454ccc1bcccc1bcc1a0cdc3182e9bad30563071375403a6eb4c134c1c4dd500ea504a229444c8cc004004dd6182798391baa01e22533307400114a2264a6660e464660a008c4a6660e866ebcc164c1d8dd50009ba6325333075306e00114bd6f7b6300991919800800a5eb7bdb180894ccc1ec0044cc1f0cdd82601014000374c00697adef6c60132323232533307c3372091010000213308001337609801014000374c00e00a2a6660f866e3d2210000213308001337609801014000374c00e0062661000266ec0dd48011ba600133006006003375660fa0066eb8c1ec008c1fc008c1f4004c8cc0040052f5bded8c044a6660f40022660f666ec13001014000375000697adef6c60132323232533307b3372091010000213307f337609801014000375000e00a2a6660f666e3d2210000213307f337609801014000375000e0062660fe66ec0dd48011ba800133006006003375a60f80066eb8c1e8008c1f8008c1f0004cdc19bad30693076375404460ba6eb0c14cc1d8dd5011099baf30583076375460b060ec6ea8004c1accc1e0dd480125eb805281bae307700213300300300114a060ee0022646609a08e464646466e3cdc919b8a0023337929412004001005375a60f060f20046eb8c1dc004c1ccdd5182a98399baa001375c60a660e26ea80745280a5014a029405280a5014a029404c94ccc1c0c1a4c1c4dd500089919191919191919299983d983f00109982d00091299983e8010980618400080689918011840808019b99375c60fe0042c6eb0c1f0004c1f0008dd7183d000983d0011b99375c60f000260f00046eb8c1d8004c1c8dd50008b183a0010991801183a0019bae307200216375c60de00260de0046eb4c1b4004c1b4008dd6183580098358011bad30690013069002375a60ce00260ce0046eb0c194004c194008dd6983180098318011bad30610013061002375c60be00260be0046eb8c174004c174008dd7182d800982d8011bae3059001305537540022c60ae60a86ea800458c0e4c14cdd5000982a98291baa00116302b001163303d021233304f3375e606e60a26ea800530103d87980004a094458dd6181898279baa019161613230023054003375c60a4004264600460a40066eb8c14000858dd6982680098268011bad304b001304b002375a609200260920046eb0c11c004c11c008dd6982280098228011bad30430013043002375c608200260820046eb8c0fc004c0fc008dd7181e800981e8011bac303b001303737540022c6072606c6ea800458c06cc0d4dd5180c181a9baa0013037303437540022c601a00c2c6eb8c0d4c0c8dd50008b180d0008b1bac30333034303430343034303430340023758606400260640046eb0c0c0004c0c0008dd6181700098151baa0252302d302e302e302e302e302e302e302e0012302c302d302d302d001222325333029301d302a37540022900009bad302e302b375400264a666052603a60546ea80045300103d87a8000132330010013756605e60586ea8008894ccc0b8004530103d87a8000132323232533302f337220100042a66605e66e3c0200084c098cc0ccdd4000a5eb80530103d87a8000133006006003375a60600066eb8c0b8008c0c8008c0c0004cc07800c00894ccc0a0004530103d87a80001301c33029302a0014bd701119198008008019129998150008a5013253330283004302d00214a2266006006002605a00246050605260526052605260520024604e6050605060506050605060500024604c604e604e604e604e604e604e604e604e604e604e0024604a604c604c604c604c604c604c604c604c604c00244646600200200644660060026004004466e212000371a0024604400246042604400244646600200200644a66604200229404c94ccc07ccdc79bae302400200414a226600600600260480024603e604060406040604060406040604060400022a66603266e1d200100913232533301b301430073300a37586040004466603866ebcc010c078dd5000a60103d87980004a094454ccc06cc03cc0100044c94ccc070c054c074dd5000899b8f00d375c6042603c6ea800458c0180045858dd6180f981018101810181018101810000980f980f980d9baa016162301e301f301f001300100122533301b0011480004c018cc008008c07800494ccc0640045300103d87a80001300d3301a301b0014bd70180080091299980c0008a4000260066600400460360026e01200222323300100100322533301800114bd7009919299980b980280109980d80119802002000899802002000980e001180d0009bad3012002375c60200022c602600264a66601c6004601e6ea800452f5bded8c026eacc04cc040dd5000998019bab3002300f375401400a6e1d200223011301230123012301200122323300100100322533301100114c103d87a800013232323253330123372200e0042a66602466e3c01c0084c024cc058dd3000a5eb80530103d87a8000133006006003375660260066eb8c044008c054008c04c004dd2a40006eb8c034c028dd50011b874800058c02cc030008c028004c028008c020004c010dd50008a4c26cacae6955ceaab9e5573eae815d0aba21";
        }
        return "590b9301010032323232323232253330023232323232533233008300130093754004264646464646464a666024602a004264646464646464646464a666032601a012264646464646464646464646464646464646464646464a66605e60466030002264a666060605260626ea80044c94ccc0c4c094c0740184c94ccc0c8c0acc0ccdd500089919299981a19b8748010c0d4dd5000899299981a9817181b1baa00113232323232323232323232323232323232323232533304c304f00213302b01322533304e00213302d0092253330500021533304d304133302837566064609e6ea8c0c8c13cdd500da451cd3c25617941168e238038f1cf6542229b919bbd6fd2b8292ce17620300375c606a609e6ea806454ccc134cdd7981898279baa3031304f37546064609e6ea806ccdd2a4004660a298011e581cd3c25617941168e238038f1cf6542229b919bbd6fd2b8292ce176203004bd70099299982729998271823981b8008a5113303400101e132533304f3043303b001132533305030493051375400226464a6660a466e1d200430533754002264a6660a6609860a86ea80044c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c94ccc1b8c1c40084cc13402c894ccc1c00084cc13c01c894ccc1c800854ccc1bccdc781f9bae30543071375403a2a6660de60c66660946eacc150c1c4dd500f83381f8a99983799baf30533071375460a660e26ea807ccdd2a4004660e6609260e26ea80752f5c02a6660de664464a6660e460cc60e66ea80044c94ccc1ccc19cc1d0dd5182c183a9baa305830753754008266e2000400c4cdc48008019bad3077307437540022940c154c1ccdd5182b18399baa0023048307137540d86eb4c120c1c4dd500e8a999837a99983799b8f375c60a860e26ea80740fc54ccc1bccdc79bae30573071375403a6eb8c150c1c4dd501d8a99983799b8f375c609260e26ea8074dd7182498389baa03b1533306f3370e6eb4c190c1c4dd500e9bad3064307137540762a6660de66e1cdd6982698389baa01d375a609a60e26ea80ec54ccc1bccdd7982718389baa01d304e307137540762a6660de66e1cdd6982418389baa01d375a609060e26ea80ec54ccc1bccdc39bad304f3071375403a6eb4c140c1c4dd501d8a99983799b8f375c60e860ea60ea60ea60ea60ea60ea60ea60ea60ea60ea60ea60e26ea8074dd7182b98389baa03b13370e6eb4c158c1c4dd500e99b80375a60ac60e26ea80ed200114a029405280a5014a029405280a5014a02a6660de66e24c16cdd6182818389baa01d375a609e60e26ea807454ccc1bcc8cc004004dd6182898391baa01e22533307400114a2264a6660e464a6660e660ac6eb8c15cc1d4dd50008a999839982b1bae305b307537540022660b26eb0c168c1d4dd50381bae305b307537540022940528183b8010998018018008a5030770011533306f533306f3068375a609a60e26ea80745288a99983798341bad30643071375403a294454ccc1bcccc1bcc1a0cdc3182e9bad30563071375403a6eb4c134c1c4dd500ea504a229444c8cc004004dd6182798391baa01e22533307400114a2264a6660e464660a008c4a6660e866ebcc164c1d8dd50009ba6325333075306e00114bd6f7b6300991919800800a5eb7bdb180894ccc1ec0044cc1f0cdd82601014000374c00697adef6c60132323232533307c3372091010000213308001337609801014000374c00e00a2a6660f866e3d2210000213308001337609801014000374c00e0062661000266ec0dd48011ba600133006006003375660fa0066eb8c1ec008c1fc008c1f4004c8cc0040052f5bded8c044a6660f40022660f666ec13001014000375000697adef6c60132323232533307b3372091010000213307f337609801014000375000e00a2a6660f666e3d2210000213307f337609801014000375000e0062660fe66ec0dd48011ba800133006006003375a60f80066eb8c1e8008c1f8008c1f0004cdc19bad30693076375404460ba6eb0c14cc1d8dd5011099baf30583076375460b060ec6ea8004c1accc1e0dd480125eb805281bae307700213300300300114a060ee0022646609a08e464646466e3cdc919b8a0023337929412004001005375a60f060f20046eb8c1dc004c1ccdd5182a98399baa001375c60a660e26ea80745280a5014a029405280a5014a029404c94ccc1c0c1a4c1c4dd500089919191919191919299983d983f00109982d00091299983e8010980618400080689918011840808019b99375c60fe0042c6eb0c1f0004c1f0008dd7183d000983d0011b99375c60f000260f00046eb8c1d8004c1c8dd50008b183a0010991801183a0019bae307200216375c60de00260de0046eb4c1b4004c1b4008dd6183580098358011bad30690013069002375a60ce00260ce0046eb0c194004c194008dd6983180098318011bad30610013061002375c60be00260be0046eb8c174004c174008dd7182d800982d8011bae3059001305537540022c60ae60a86ea800458c0e4c14cdd5000982a98291baa00116302b001163303d021233304f3375e606e60a26ea800530103d87980004a094458dd6181898279baa019161613230023054003375c60a4004264600460a40066eb8c14000858dd6982680098268011bad304b001304b002375a609200260920046eb0c11c004c11c008dd6982280098228011bad30430013043002375c608200260820046eb8c0fc004c0fc008dd7181e800981e8011bac303b001303737540022c6072606c6ea800458c06cc0d4dd5180c181a9baa0013037303437540022c601a00c2c6eb8c0d4c0c8dd50008b180d0008b1bac30333034303430343034303430340023758606400260640046eb0c0c0004c0c0008dd6181700098151baa0252302d302e302e302e302e302e302e302e0012302c302d302d302d001222325333029301d302a37540022900009bad302e302b375400264a666052603a60546ea80045300103d87a8000132330010013756605e60586ea8008894ccc0b8004530103d87a8000132323232533302f337220100042a66605e66e3c0200084c098cc0ccdd4000a5eb80530103d87a8000133006006003375a60600066eb8c0b8008c0c8008c0c0004cc07800c00894ccc0a0004530103d87a80001301c33029302a0014bd701119198008008019129998150008a5013253330283004302d00214a2266006006002605a00246050605260526052605260520024604e6050605060506050605060500024604c604e604e604e604e604e604e604e604e604e604e0024604a604c604c604c604c604c604c604c604c604c00244646600200200644660060026004004466e212000371a0024604400246042604400244646600200200644a66604200229404c94ccc07ccdc79bae302400200414a226600600600260480024603e604060406040604060406040604060400022a66603266e1d200100913232533301b301430073300a37586040004466603866ebcc010c078dd5000a60103d87980004a094454ccc06cc03cc0100044c94ccc070c054c074dd5000899b8f00d375c6042603c6ea800458c0180045858dd6180f981018101810181018101810000980f980f980d9baa016162301e301f301f001300100122533301b0011480004c018cc008008c07800494ccc0640045300103d87a80001300d3301a301b0014bd70180080091299980c0008a4000260066600400460360026e01200222323300100100322533301800114bd7009919299980b980280109980d80119802002000899802002000980e001180d0009bad3012002375c60200022c602600264a66601c6004601e6ea800452f5bded8c026eacc04cc040dd5000998019bab3002300f375401400a6e1d200223011301230123012301200122323300100100322533301100114c103d87a800013232323253330123372200e0042a66602466e3c01c0084c024cc058dd3000a5eb80530103d87a8000133006006003375660260066eb8c044008c054008c04c004dd2a40006eb8c034c028dd50011b874800058c02cc030008c028004c028008c020004c010dd50008a4c26cacae6955ceaab9e5573eae815d0aba21";
    }

    public static String getMintStateTokenHash(CardanoNetwork network) {
        if (network.equals(CardanoNetwork.MAINNET)) {
            return "1919c122cba719a9bf760e4e463bbcf8a3d46327569cdb5edd8b7d0e";
        }
        return "6b3a786359bfb307baa3be8cc4fa9872c219c42b76226a4f97d90a62";
    }

    public static String getUpdateStateTokenCode(CardanoNetwork network) {
        if (network.equals(CardanoNetwork.MAINNET)) {
            return "590b3a01010032323232323232253330023232323232533233008300130093754004264646646464646464646464646464646464646464646464646464646446464a66604e600e60506ea80044c8c94ccc0a4cdc3a400860546ea80044c8cc02400454ccc0a8c08cc060dd6181018161baa0271533302a3375e60106eb0c080c0b0dd5013980919817180f98161baa0014bd700a99981518119998039bab301f302c3754603e60586ea800d2211c1919c122cba719a9bf760e4e463bbcf8a3d46327569cdb5edd8b7d0e00375c603e60586ea80044c8c94ccc0b0c0940044c8c94ccc0b8c038c0bcdd50008992999817981418088028992999818180818189baa00113253330313375e604860666ea8004c090c0ccdd5181318199baa00313253330323370e900218199baa0011323301200115333033302c33301037566050606a6ea800d22011c1919c122cba719a9bf760e4e463bbcf8a3d46327569cdb5edd8b7d0e00375c6050606a6ea80284c8c94ccc0d4c94ccc0d8cdc4240006eb4c0b0c0e0dd500689919299981c1818981c9baa00113253330393032303a3754605c60766ea8c0b8c0ecdd5002099b880010031337120020066eb4c0f4c0e8dd50008a50302a30393754605860726ea8008dd6980d181c1baa00d14a06032606e6ea80c854ccc0d400854ccc0d400454ccc0d4cdc4980b9bac301a303737540066eb4c06cc0dcdd5001899198008009bac301b3038375400844a66607400229444c94ccc0e0c94ccc0e4c0acdd71816181d9baa00115333039302b375c605a60766ea80044c8c8cc004004dd61818981e9baa03822533303f00114a0264a66607a66e3cdd718210010020a511330030030013042001375c605a60766ea80045280a50303d00213300300300114a0607a00229405280a5014a0a66606860286eb4c07cc0d8dd50010a51153330343014375a603c606c6ea80085288a99981a19981a180a19b863024375a6054606c6ea8008dd6980f981b1baa0024a0944528899198008009bac30213037375400644a66607200229444c94ccc0dcc8c8cc004004034894ccc0f4004528099299981d99299981e19baf3031303e37540026e98c94ccc0f4c07400452f5bded8c0264646600200297adef6c60225333043001133044337609801014000374c00697adef6c60132323232533304433720910100002133048337609801014000374c00e00a2a66608866e3d22100002133048337609801014000374c00e00626609066ec0dd48011ba6001330060060033756608a0066eb8c10c008c11c008c114004c8cc0040052f5bded8c044a66608400226608666ec13001014000375000697adef6c60132323232533304333720910100002133047337609801014000375000e00a2a66608666e3d22100002133047337609801014000375000e00626608e66ec0dd48011ba800133006006003375a60880066eb8c108008c118008c110004cdc19bad3026303e375401460546eb0c0a0c0f8dd5005099baf302f303e3754605e607c6ea8004c090cc100dd4802a5eb8052818200010a511330030030013040001375c60780042660060060022940c0f00054ccc0cccdc79bae3026303537540026eb8c098c0d4dd50050a99981999b8f375c6050606a6ea8004dd71814181a9baa00a153330333371e6eb8c09cc0d4dd50009bae3027303537540142a66606666e3cdd7180e181a9baa001375c6038606a6ea802854ccc0cccdc39bad301d303537540026eb4c074c0d4dd50050a99981999b87375a603c606a6ea8004dd6980f181a9baa00a153330333375e603e606a6ea8004c07cc0d4dd50050a99981999b87375a602e606a6ea8004dd6980b981a9baa00a153330333370e6eb4c064c0d4dd50009bad3019303537540142a66606666e3cdd71810181a9baa001375c6040606a6ea80284cdc39bad30293035375400266e00dd69814981a9baa00a480045280a5014a029405280a5014a029405280a50163037303437540022c604a60666ea800458c0d4c0c8dd50008b29998190028a60103d87a8000130173303330340054bd700b181998181baa001163300e37586040605e6ea80a8024dd618189819181918171baa0291533302c300c0011533302c300c300e0021533302c3025301a37586044605c6ea80a44c94ccc0b4c034c0b8dd500089919192999819981b001099299981899b87375a606600490008a99981899b8f00100413371e6eb8c098c0ccdd50040020a5014a06eb8c0c400458c0d0004c94ccc0bcc0a0c0c0dd50008a5eb7bdb1804dd5981a18189baa001330153756603060606ea80ad22011c1919c122cba719a9bf760e4e463bbcf8a3d46327569cdb5edd8b7d0e00375c6064605e6ea800458c028dd6181118171baa0291614a02c646600200200e44a6660600022900009991299981798141998061bab30243031375400491011c1919c122cba719a9bf760e4e463bbcf8a3d46327569cdb5edd8b7d0e00375c604860626ea80184c07c0044004c0c8004cc008008c0cc004c8cc004004018894ccc0bc00452f5c026464a66605c66605c66ebcc088c0c0dd500126103d87980004a09444cc0c8008cc0100100044cc010010004c0cc008c0c4004585858c0b8c0acdd50008b180e18151baa301d302a3754002605860526ea800458cc01cdd6180c98141baa0230023758605460566056604e6ea8088888c94ccc09cc080c0a0dd50008a400026eb4c0b0c0a4dd5000992999813981018141baa00114c103d87a8000132330010013756605a60546ea8008894ccc0b0004530103d87a8000132323232533302d337220100042a66605a66e3c0200084c054cc0c4dd4000a5eb80530103d87a8000133006006003375a605c0066eb8c0b0008c0c0008c0b8004cc03400c00894ccc098004530103d87a80001300b3302730280014bd70112999811980198121baa0021323232323232323232323232323232323232323232323232533303e304100213302c00b22533304000213302e0072253330420021501d132533304030203041375400226464646464646464a666096609c00426607200244a66609a0042601860a001a264600460a20066e64dd718278010b1bac304c001304c002375c609400260940046e64dd7182400098240011bae3046001304237540022c6088004264600460880066eb8c10800858dd7181f800981f8011bad303d001303d0023758607600260760046eb4c0e4004c0e4008dd6981b800981b8011bac30350013035002375a606600260660046eb4c0c4004c0c4008dd7181780098178011bae302d001302d002375c605600260560046eb8c0a4004c094dd50010b1b874800088c8cc00400400c894ccc098004530103d87a80001323253330253375e6030604e6ea80080144c034cc0a40092f5c026600800800260540046050002600200244a6660440022900009807998010011812800918111811981198119811981198119811800918109811181118111811181118111811181118110009181018109810981098109810981098109810981098108009119198008008019129998100008a6103d87a800013232323253330213372200e0042a66604266e3c01c0084c024cc094dd3000a5eb80530103d87a8000133006006003375660440066eb8c080008c090008c088004dd2a40004603a603c603c603c00246038603a603a603a603a0024603660386038603860386038002460346036603660366036603660360024603260346034603460346034603460346034603460346034002600200244a66602c002290000980199801001180c8009b804800888c8cc00400400c88cc00c004c0080088cdc4240006e340048c04c0048c048c04cc04c0048c044c0480048c040c044c044c044c044c044c044c044c044004c03c008c038c03c004c028dd50011b874800858c02cc030008c028004c028008c020004c010dd50008a4c26cacae6955ceaab9e5573eae815d0aba21";
        }
        return "590b3a01010032323232323232253330023232323232533233008300130093754004264646646464646464646464646464646464646464646464646464646446464a66604e600e60506ea80044c8c94ccc0a4cdc3a400860546ea80044c8cc02400454ccc0a8c08cc060dd6181018161baa0271533302a3375e60106eb0c080c0b0dd5013980919817180f98161baa0014bd700a99981518119998039bab301f302c3754603e60586ea800d2211c6b3a786359bfb307baa3be8cc4fa9872c219c42b76226a4f97d90a6200375c603e60586ea80044c8c94ccc0b0c0940044c8c94ccc0b8c038c0bcdd50008992999817981418088028992999818180818189baa00113253330313375e604860666ea8004c090c0ccdd5181318199baa00313253330323370e900218199baa0011323301200115333033302c33301037566050606a6ea800d22011c6b3a786359bfb307baa3be8cc4fa9872c219c42b76226a4f97d90a6200375c6050606a6ea80284c8c94ccc0d4c94ccc0d8cdc4240006eb4c0b0c0e0dd500689919299981c1818981c9baa00113253330393032303a3754605c60766ea8c0b8c0ecdd5002099b880010031337120020066eb4c0f4c0e8dd50008a50302a30393754605860726ea8008dd6980d181c1baa00d14a06032606e6ea80c854ccc0d400854ccc0d400454ccc0d4cdc4980b9bac301a303737540066eb4c06cc0dcdd5001899198008009bac301b3038375400844a66607400229444c94ccc0e0c94ccc0e4c0acdd71816181d9baa00115333039302b375c605a60766ea80044c8c8cc004004dd61818981e9baa03822533303f00114a0264a66607a66e3cdd718210010020a511330030030013042001375c605a60766ea80045280a50303d00213300300300114a0607a00229405280a5014a0a66606860286eb4c07cc0d8dd50010a51153330343014375a603c606c6ea80085288a99981a19981a180a19b863024375a6054606c6ea8008dd6980f981b1baa0024a0944528899198008009bac30213037375400644a66607200229444c94ccc0dcc8c8cc004004034894ccc0f4004528099299981d99299981e19baf3031303e37540026e98c94ccc0f4c07400452f5bded8c0264646600200297adef6c60225333043001133044337609801014000374c00697adef6c60132323232533304433720910100002133048337609801014000374c00e00a2a66608866e3d22100002133048337609801014000374c00e00626609066ec0dd48011ba6001330060060033756608a0066eb8c10c008c11c008c114004c8cc0040052f5bded8c044a66608400226608666ec13001014000375000697adef6c60132323232533304333720910100002133047337609801014000375000e00a2a66608666e3d22100002133047337609801014000375000e00626608e66ec0dd48011ba800133006006003375a60880066eb8c108008c118008c110004cdc19bad3026303e375401460546eb0c0a0c0f8dd5005099baf302f303e3754605e607c6ea8004c090cc100dd4802a5eb8052818200010a511330030030013040001375c60780042660060060022940c0f00054ccc0cccdc79bae3026303537540026eb8c098c0d4dd50050a99981999b8f375c6050606a6ea8004dd71814181a9baa00a153330333371e6eb8c09cc0d4dd50009bae3027303537540142a66606666e3cdd7180e181a9baa001375c6038606a6ea802854ccc0cccdc39bad301d303537540026eb4c074c0d4dd50050a99981999b87375a603c606a6ea8004dd6980f181a9baa00a153330333375e603e606a6ea8004c07cc0d4dd50050a99981999b87375a602e606a6ea8004dd6980b981a9baa00a153330333370e6eb4c064c0d4dd50009bad3019303537540142a66606666e3cdd71810181a9baa001375c6040606a6ea80284cdc39bad30293035375400266e00dd69814981a9baa00a480045280a5014a029405280a5014a029405280a50163037303437540022c604a60666ea800458c0d4c0c8dd50008b29998190028a60103d87a8000130173303330340054bd700b181998181baa001163300e37586040605e6ea80a8024dd618189819181918171baa0291533302c300c0011533302c300c300e0021533302c3025301a37586044605c6ea80a44c94ccc0b4c034c0b8dd500089919192999819981b001099299981899b87375a606600490008a99981899b8f00100413371e6eb8c098c0ccdd50040020a5014a06eb8c0c400458c0d0004c94ccc0bcc0a0c0c0dd50008a5eb7bdb1804dd5981a18189baa001330153756603060606ea80ad22011c6b3a786359bfb307baa3be8cc4fa9872c219c42b76226a4f97d90a6200375c6064605e6ea800458c028dd6181118171baa0291614a02c646600200200e44a6660600022900009991299981798141998061bab30243031375400491011c6b3a786359bfb307baa3be8cc4fa9872c219c42b76226a4f97d90a6200375c604860626ea80184c07c0044004c0c8004cc008008c0cc004c8cc004004018894ccc0bc00452f5c026464a66605c66605c66ebcc088c0c0dd500126103d87980004a09444cc0c8008cc0100100044cc010010004c0cc008c0c4004585858c0b8c0acdd50008b180e18151baa301d302a3754002605860526ea800458cc01cdd6180c98141baa0230023758605460566056604e6ea8088888c94ccc09cc080c0a0dd50008a400026eb4c0b0c0a4dd5000992999813981018141baa00114c103d87a8000132330010013756605a60546ea8008894ccc0b0004530103d87a8000132323232533302d337220100042a66605a66e3c0200084c054cc0c4dd4000a5eb80530103d87a8000133006006003375a605c0066eb8c0b0008c0c0008c0b8004cc03400c00894ccc098004530103d87a80001300b3302730280014bd70112999811980198121baa0021323232323232323232323232323232323232323232323232533303e304100213302c00b22533304000213302e0072253330420021501d132533304030203041375400226464646464646464a666096609c00426607200244a66609a0042601860a001a264600460a20066e64dd718278010b1bac304c001304c002375c609400260940046e64dd7182400098240011bae3046001304237540022c6088004264600460880066eb8c10800858dd7181f800981f8011bad303d001303d0023758607600260760046eb4c0e4004c0e4008dd6981b800981b8011bac30350013035002375a606600260660046eb4c0c4004c0c4008dd7181780098178011bae302d001302d002375c605600260560046eb8c0a4004c094dd50010b1b874800088c8cc00400400c894ccc098004530103d87a80001323253330253375e6030604e6ea80080144c034cc0a40092f5c026600800800260540046050002600200244a6660440022900009807998010011812800918111811981198119811981198119811800918109811181118111811181118111811181118110009181018109810981098109810981098109810981098108009119198008008019129998100008a6103d87a800013232323253330213372200e0042a66604266e3c01c0084c024cc094dd3000a5eb80530103d87a8000133006006003375660440066eb8c080008c090008c088004dd2a40004603a603c603c603c00246038603a603a603a603a0024603660386038603860386038002460346036603660366036603660360024603260346034603460346034603460346034603460346034002600200244a66602c002290000980199801001180c8009b804800888c8cc00400400c88cc00c004c0080088cdc4240006e340048c04c0048c048c04cc04c0048c044c0480048c040c044c044c044c044c044c044c044c044004c03c008c038c03c004c028dd50011b874800858c02cc030008c028004c028008c020004c010dd50008a4c26cacae6955ceaab9e5573eae815d0aba21";
    }

    public static String getUpdateStateTokenHash(CardanoNetwork network) {
        if (network.equals(CardanoNetwork.MAINNET)) {
            return "314cdf9ea60ee354ff1b87da74f15dedd4070604b2819a1d6bac3453";
        }
        return "f2f25cfcc4e1665bad2477fc1aa6e9960ae59ef1681eae28a0bfed16";
    }

    public static Optional<Utxo> getUtxoByTransactionAndUnit(String transactionHash, String unit, BackendService backendService) {
        Result<TxContentUtxo> transactionUtxos;
        try {
            transactionUtxos = backendService.getTransactionService().getTransactionUtxos(transactionHash);
        } catch (ApiException e) {
            log.error("Error getting transaction utxos: {}", e.getMessage());
            return Optional.empty();
        }

        if (transactionUtxos.isSuccessful()) {
            for (TxContentUtxoOutputs output : transactionUtxos.getValue().getOutputs()) {
                Optional<TxContentOutputAmount> outputWithUnit = output.getAmount().stream().filter(amount -> amount.getUnit().equals(unit)).findFirst();
                if (outputWithUnit.isPresent()) {
                    return Optional.of(output.toUtxos(transactionHash));
                }
            }
        } else {
            log.error("Error getting transaction utxos: {}", transactionUtxos.getResponse());
        }

        return Optional.empty();
    }

    public static String extractStringFromPlutusData(PlutusData plutusData) {
        return new String(((BytesPlutusData) plutusData).getValue());
    }

    public static String extractByteArrayFromPlutusData(PlutusData plutusData) {
        return HexUtil.encodeHexString(((BytesPlutusData) plutusData).getValue());
    }

    public static List<byte[]> extractListFromPlutusData(PlutusData plutusData) {
        return ((ListPlutusData) plutusData).getPlutusDataList().stream()
                .map(item -> ((BytesPlutusData) item).getValue())
                .collect(Collectors.toList());
    }

    public static Integer extractIntegerFromPlutusData(PlutusData plutusData) {
        return ((BigIntPlutusData) plutusData).getValue().intValue();
    }

    public static Boolean extractBooleanFromPlutusData(PlutusData plutusData) {
        return ((ConstrPlutusData) plutusData).getAlternative() == 1;
    }

    public static Long extractLongFromPlutusData(PlutusData plutusData) {
        return ((BigIntPlutusData) plutusData).getValue().longValue();
    }

    public static boolean includesStateToken(TransactionOutput output) {
        return output.getValue().getMultiAssets().stream().anyMatch(
                asset -> asset.getPolicyId() != null && asset.getPolicyId().equalsIgnoreCase(getMintStateTokenHash(CardanoNetwork.MAINNET))
                        || asset.getPolicyId().equalsIgnoreCase(getMintStateTokenHash(CardanoNetwork.PREPROD))
        );
    }

    public static boolean includesStateToken(AddressUtxo addressUtxo, CardanoNetwork network) {
        return addressUtxo.getAmounts().stream()
                .anyMatch(asset -> asset.getPolicyId() != null && asset.getPolicyId().equals(ValidatorUtils.getMintStateTokenHash(network)));

    }

    public static boolean includesBootstrapToken(AddressUtxo addressUtxo, CardanoNetwork network) {
        return addressUtxo.getAmounts().stream()
                .anyMatch(asset -> asset.getPolicyId() != null && asset.getPolicyId().equals(ValidatorUtils.getMintOrBurnAuthTokenHash(network)));
    }

    public static boolean isMintingTransaction(AddressUtxo addressUtxo, String policyId) {
        return addressUtxo.getAmounts().stream()
                .anyMatch(input -> input.getPolicyId() != null && input.getPolicyId().equals(policyId) &&
                        input.getQuantity().equals(BigInteger.ONE));
    }

    public static boolean isBurningTransaction(AddressUtxo addressUtxo, String policyId) {
        return addressUtxo.getAmounts().stream()
                .anyMatch(input -> input.getPolicyId() != null && input.getPolicyId().equals(policyId) &&
                        input.getQuantity().equals(BigInteger.valueOf(-1)));
    }

    public static String getBootstrapTokenName(AddressUtxo addressUtxo, CardanoNetwork network) {
        return addressUtxo.getAmounts().stream()
                .filter(input -> input.getPolicyId() != null && input.getPolicyId().equals(getMintOrBurnAuthTokenHash(network)))
                .findFirst()
                .map(Amt::getAssetName)
                .orElseThrow(() -> new IllegalArgumentException("Bootstrap token not found"));
    }
}
