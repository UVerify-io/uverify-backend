server:
  port: ${PORT:9090}

spring:
  profiles:
    active: ${SPRING_ACTIVE_PROFILES:preprod,h2}
  main:
    banner-mode: off
  flyway:
    locations:
      - classpath:db/store/{vendor}
      - classpath:db/migration/uverify
    out-of-order: true
  datasource:
    url: ${DB_URL:jdbc:h2:./data/db}
    username: ${DB_USERNAME:sa}
    password: ${DB_PASSWORD:password}

springdoc:
  writer-with-default-pretty-printer: true
  api-docs:
    path: /v1/api-docs
  swagger-ui:
    path: /swagger-ui.html
    display-request-duration: true

apiPrefix: /api/v1

logging:
  file:
    name: ./logs/uverify-backend.log

management:
  endpoints:
    web:
      exposure:
        include:
          - health
          - info
          - prometheus

store:
  cardano:
    host: ${REMOTE_NODE_URL:backbone.cardano.iog.io}
    port: ${REMOTE_NODE_PORT:3001}
    protocol-magic: 764824073
    sync-start-slot: 153422988
    sync-start-blockhash: c6b1c0eebd697a25bbcc429f4d66258b83db07ad060b13065612e50410bda7b2
  blocks:
    epoch-calculation-interval=14400:  # 14400 = 4 hours

cors:
  allowed-origins: ${CORS_ALLOWED_ORIGINS:*}

cardano:
  network: ${CARDANO_NETWORK:preprod}
  facilitator:
    user:
      mnemonic: ${FACILITATOR_ACCOUNT_MNEMONIC}
  service:
    user:
      address: ${SERVICE_USER_ADDRESS}
  backend:
    service:
      type: ${CARDANO_BACKEND_TYPE:blockfrost}
    blockfrost:
      projectId: ${BLOCKFROST_PROJECT_ID}
      baseUrl: ${BLOCKFROST_BASE_URL}

extensions:
  connected-goods:
    encryption:
      salt: ${CONNECTED_GOODS_ENCRYPTION_SALT}
    enabled: ${CONNECTED_GOODS_EXTENSION_ENABLED:true}
    service-wallet:
      address: ${CONNECTED_GOODS_SERVICE_WALLET_ADDRESS}

---
spring:
  config:
    activate:
      on-profile: https
server:
  port: ${SSL_PORT:8443}
  http:
    port: ${PORT:9090}
  ssl:
    key-store: classpath:keystore.p12
    key-store-password: ${KEY_STORE_PASSWORD}
    key-store-type: PKCS12
    key-alias: api_uverify_io
---
spring:
  config:
    activate:
      on-profile: disable-indexer

store:
  sync-auto-start: false
---
spring:
  config:
    activate:
      on-profile: postgres
  datasource:
    driverClassName: ${DB_DRIVER:org.postgresql.Driver}
    url: ${DB_URL:jdbc:postgresql://localhost:5432/uverify}
---
spring:
  config:
    activate:
      on-profile: h2
  jpa:
    database-platform: ${DB_DIALECT:org.hibernate.dialect.H2Dialect}
  h2:
    console:
      enabled: true
---
spring:
  config:
    activate:
      on-profile: test
  jpa:
    database-platform: ${DB_DIALECT:org.hibernate.dialect.H2Dialect}
  h2:
    console:
      enabled: true
  datasource:
    url: ${DB_URL:jdbc:h2:mem:uverify}
    username: ${DB_USERNAME:sa}
    password: ${DB_PASSWORD:password}
---
spring:
  config:
    activate:
      on-profile: preprod
store:
  cardano:
    host: ${REMOTE_NODE_URL:preprod-node.world.dev.cardano.org}
    port: ${REMOTE_NODE_PORT:30000}
    protocol-magic: ${PROTOCOL_MAGIC:1}
    sync-start-slot: 80086574
    sync-start-blockhash: 4f9308fcc35bc2fffc399171dc36d3730bcd4f4e9349dd59362f1fdb8604fde8
---